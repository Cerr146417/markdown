# 第1章 学习指南

###  1-1 课程导学 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200211150140260.png" alt="image-20200211150140260" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200211162525688.png" alt="image-20200211162525688" style="zoom: 33%;" />

###  1-2 课程学习与解决问题指南

 前台： 

- http://www.happymmall.com/index.html 
- http://test.happymmall.com/ 

 后台： 

- [http://admin.happymmall.com](http://admin.happymmall.com/)  账号密码 admin/admin 
- http://admintest.happymmall.com/  账号密码 admin/admin 

 学习资料与软件下载：http://learning.happymmall.com/ 

**手记推荐**

[大型项目架构演进过程及思考的点](http://www.imooc.com/article/17545)

[找工作的季节之简历及找工作的分享](http://www.imooc.com/article/19998)

[一期项目思维导图&知识点索引](http://www.imooc.com/article/20193)

[一期课程问答FAQ](https://www.imooc.com/article/18998)

[一期课程QQ群分享手记](https://www.imooc.com/article/19094)

### 1-3 大型Java项目架构演进解析 

单点登录

![image-20200211203419899](http://woshiamiaojiang.gitee.io/image-hosting/image-20200211203419899.png)

读写分离

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200211203641866.png" alt="image-20200211203641866" style="zoom: 25%;" />

数据库

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200211204802794.png" alt="image-20200211204802794" style="zoom: 25%;" />

分布式文件集群

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200211205312102.png" alt="image-20200211205312102" style="zoom:25%;" />

###   1-4 项目功能与业务逻辑介绍 

###  1-5 课程安排与学习收获

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200211211822583.png" alt="image-20200211211822583" style="zoom: 25%;" />

# 第2章 linux系统下开发环境安装与配置指导

###  2-1 linux软件源配置与学习建议

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200211223957493.png" alt="image-20200211223957493" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200211224821180.png" alt="image-20200211224821180" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200211224429374.png" alt="image-20200211224429374" style="zoom: 25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200211225318251.png" alt="image-20200211225318251" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200211225401496.png" alt="image-20200211225401496" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200211225438735.png" alt="image-20200211225438735" style="zoom:25%;" />

###  2-2 linux软件源配置实操

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212105213023.png" alt="image-20200212105213023" style="zoom: 33%;" />

###  2-3 jdk安装讲解

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212113235229.png" alt="image-20200212113235229" style="zoom: 25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212113348702.png" alt="image-20200212113348702" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212113442344.png" alt="image-20200212113442344" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212113801709.png" alt="image-20200212113801709" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212144434658.png" alt="image-20200212144434658" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212144522948.png" alt="image-20200212144522948" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212144621323.png" alt="image-20200212144621323" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212144708100.png" alt="image-20200212144708100" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212144852397.png" alt="image-20200212144852397" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212145050601.png" alt="image-20200212145050601" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212145112827.png" alt="image-20200212145112827" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212145155888.png" alt="image-20200212145155888" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212145213383.png" alt="image-20200212145213383" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212145239300.png" alt="image-20200212145239300" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212145303915.png" alt="image-20200212145303915" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212145421280.png" alt="image-20200212145421280" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212145454136.png" alt="image-20200212145454136" style="zoom:25%;" />

###  2-4 jdk安装实操

卸载原有jdk

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212150347514.png" alt="image-20200212150347514" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212150413160.png" alt="image-20200212150413160" style="zoom:33%;" />

下载安装生效

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212150834963.png" alt="image-20200212150834963" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212151157758.png" alt="image-20200212151157758" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212151245578.png" alt="image-20200212151245578" style="zoom:33%;" />

###  2-5 tomcat安装讲解

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212151417887.png" alt="image-20200212151417887" style="zoom: 25%;" />



<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212151450622.png" alt="image-20200212151450622" style="zoom:25%;" />

#### linux安装

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212151532151.png" alt="image-20200212151532151" style="zoom:25%;" />



<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212151646942.png" alt="image-20200212151646942" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212151841514.png" alt="image-20200212151841514" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212151724757.png" alt="image-20200212151724757" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212151935176.png" alt="image-20200212151935176" style="zoom: 25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212152037958.png" alt="image-20200212152037958" style="zoom: 25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212152056195.png" alt="image-20200212152056195" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212152154982.png" alt="image-20200212152154982" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212152245367.png" alt="image-20200212152245367" style="zoom: 25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212152348951.png" alt="image-20200212152348951" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212152401846.png" alt="image-20200212152401846" style="zoom: 33%;" />

#### windows安装

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212152451174.png" alt="image-20200212152451174" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212152650917.png" alt="image-20200212152650917" style="zoom: 25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212153328063.png" alt="image-20200212153328063" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212153409244.png" alt="image-20200212153409244" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212153429578.png" alt="image-20200212153429578" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212155815160.png" alt="image-20200212155815160" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212160000561.png" alt="image-20200212160000561" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212160413047.png" alt="image-20200212160413047" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212160422027.png" alt="image-20200212160422027" style="zoom:33%;" />

#### tomcat常用命令

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212160530688.png" alt="image-20200212160530688" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212160708845.png" alt="image-20200212160708845" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212160730880.png" alt="image-20200212160730880" style="zoom:25%;" />

### 2-6 tomcat安装实操

###  2-7 maven项目构建与管理工具安装讲解

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212160954582.png" alt="image-20200212160954582" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212161036530.png" alt="image-20200212161036530" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212161121829.png" alt="image-20200212161121829" style="zoom:25%;" />

##### linux

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212161320487.png" alt="image-20200212161320487" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212161436463.png" alt="image-20200212161436463" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212161528701.png" alt="image-20200212161528701" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212161602890.png" alt="image-20200212161602890" style="zoom:33%;" />

##### windows

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212161722617.png" alt="image-20200212161722617" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212161739758.png" alt="image-20200212161739758" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212161814342.png" alt="image-20200212161814342" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212161829008.png" alt="image-20200212161829008" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212161842745.png" alt="image-20200212161842745" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212161948289.png" alt="image-20200212161948289" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212162006141.png" alt="image-20200212162006141" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212162018201.png" alt="image-20200212162018201" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212162056701.png" alt="image-20200212162056701" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212162110763.png" alt="image-20200212162110763" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212162252499.png" alt="image-20200212162252499" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212162320515.png" alt="image-20200212162320515" style="zoom:25%;" />

###   2-8 maven项目构建与管理工具安装实操 

###   2-9 vsftpd文件服务器安装与配置讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212163332876.png" alt="image-20200212163332876" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212163425293.png" alt="image-20200212163425293" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212163938628.png" alt="image-20200212163938628" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212164037679.png" alt="image-20200212164037679" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212164840673.png" alt="image-20200212164840673" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212170109389.png" alt="image-20200212170109389" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212170139982.png" alt="image-20200212170139982" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212170239591.png" alt="image-20200212170239591" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212170253947.png" alt="image-20200212170253947" style="zoom:25%;" />

```html
本项目要用到的配置项：
1）local_root=/ftpfile(当本地用户登入时，将被更换到定义的目录下，默认值为各用户的家目录)
2）anon_root=/ftpfile(使用匿名登入时，所登入的目录)
3）use_localtime=YES(默认是GMT时间，改成使用本机系统时间)
4）anonymous_enable=NO(不允许匿名用户登录)
5）local_enable=YES(允许本地用户登录)
6）write_enable=YES(本地用户可以在自己家目录中进行读写操作)
7）local_umask=022(本地用户新增档案时的umask值)
8）dirmessage_enable=YES(如果启动这个选项，那么使用者第一次进入一个目录时，会检查该目录下是否有.message这个档案，如果有，则会出现此档案的内容，通常这个档案会放置欢迎话语，或是对该目录的说明。默认值为开启)
9）xferlog_enable=YES(是否启用上传/下载日志记录。如果启用，则上传与下载的信息将被完整纪录在xferlog_file 所定义的档案中。预设为开启。)
10）connect_from_port_20=YES(指定FTP使用20端口进行数据传输，默认值为YES)
11）xferlog_std_format=YES(如果启用，则日志文件将会写成xferlog的标准格式)
12）ftpd_banner=Welcome to mmall FTP Server(这里用来定义欢迎话语的字符串)
13）chroot_local_user=NO(用于指定用户列表文件中的用户是否允许切换到上级目录)
14）chroot_list_enable=YES(设置是否启用chroot_list_file配置项指定的用户列表文件)
15）chroot_list_file=/etc/vsftpd/chroot_list(用于指定用户列表文件)
16）listen=YES(设置vsftpd服务器是否以standalone模式运行，以standalone模式运行是一种较好的方式，此时listen必须设置为YES，此为默认值。建议不要更改，有很多与服务器运行相关的配置命令，需要在此模式下才有效，若设置为NO，则vsftpd不是以独立的服务运行，要受到xinetd服务的管控，功能上会受到限制)
17）pam_service_name=vsftpd(虚拟用户使用PAM认证方式，这里是设置PAM使用的名称，默认即可，与/etc/pam.d/vsftpd对应) userlist_enable=YES(是否启用vsftpd.user_list文件，黑名单,白名单都可以
18)pasv_min_port=61001(被动模式使用端口范围最小值)
19)pasv_max_port=62000(被动模式使用端口范围最大值)
20)pasv_enable=YES(pasv_enable=YES/NO（YES）
若设置为YES，则使用PASV工作模式；若设置为NO，则使用PORT模式。默认值为YES，即使用PASV工作模式。
   FTP协议有两种工作方式：PORT方式和PASV方式，中文意思为主动式和被动式。
   一、PORT（主动）方式的连接过程是：客户端向服务器的FTP端口（默认是21）发送连接请求，服务器接受连接，建立一条命令链路。
  当需要传送数据时，客户端在命令链路上用 PORT命令告诉服务器：“我打开了****端口，你过来连接我”。于是服务器从20端口向客户端的****端口发送连接请求，建立一条数据链路来传送数据。
   二、PASV（被动）方式的连接过程是：客户端向服务器的FTP端口（默认是21）发送连接请求，服务器接受连接，建立一条命令链路。
  当需要传送数据时，服务器在命令链路上用 PASV命令告诉客户端：“我打开了****端口，你过来连接我”。于是客户端向服务器的****端口发送连接请求，建立一条数据链路来传送数据。
  从上面可以看出，两种方式的命令链路连接方法是一样的，而数据链路的建立方法就完全不同。而FTP的复杂性就在于此。
)
```

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212195108077.png" alt="image-20200212195108077" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212195147540.png" alt="image-20200212195147540" style="zoom: 33%;" />





![image-20200212201450724](http://woshiamiaojiang.gitee.io/image-hosting/image-20200212201450724.png)



![image-20200212201524817](http://woshiamiaojiang.gitee.io/image-hosting/image-20200212201524817.png)

![image-20200212201553493](http://woshiamiaojiang.gitee.io/image-hosting/image-20200212201553493.png)

![image-20200212201754138](http://woshiamiaojiang.gitee.io/image-hosting/image-20200212201754138.png)

![image-20200212201628990](http://woshiamiaojiang.gitee.io/image-hosting/image-20200212201628990.png)

![image-20200212201703368](http://woshiamiaojiang.gitee.io/image-hosting/image-20200212201703368.png)

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212201811678.png" alt="image-20200212201811678" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212201838629.png" alt="image-20200212201838629" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212201902832.png" alt="image-20200212201902832" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212201923395.png" alt="image-20200212201923395" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212201942180.png" alt="image-20200212201942180" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212201957501.png" alt="image-20200212201957501" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212202017401.png" alt="image-20200212202017401" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212202036244.png" alt="image-20200212202036244" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212202058325.png" alt="image-20200212202058325" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212202144969.png" alt="image-20200212202144969" style="zoom:25%;" />

###  2-10 vsftpd文件服务器安装与配置实操 

###  2-11 nginx反向代理服务器安装与配置讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212204004922.png" alt="image-20200212204004922" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212212351791.png" alt="image-20200212212351791" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212212414054.png" alt="image-20200212212414054" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212212922939.png" alt="image-20200212212922939" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212212957638.png" alt="image-20200212212957638" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212213041189.png" alt="image-20200212213041189" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212213635260.png" alt="image-20200212213635260" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212213253205.png" alt="image-20200212213253205" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212213315651.png" alt="image-20200212213315651" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212213706968.png" alt="image-20200212213706968" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212213727501.png" alt="image-20200212213727501" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212213758424.png" alt="image-20200212213758424" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212223829824.png" alt="image-20200212223829824" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212224023238.png" alt="image-20200212224023238" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212224133926.png" alt="image-20200212224133926" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212224151423.png" alt="image-20200212224151423" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212224212599.png" alt="image-20200212224212599" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212224234554.png" alt="image-20200212224234554" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212224300748.png" alt="image-20200212224300748" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212225029992.png" alt="image-20200212225029992" style="zoom: 25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212225120280.png" alt="image-20200212225120280" style="zoom: 25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212225144836.png" alt="image-20200212225144836" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212225206950.png" alt="image-20200212225206950" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212225244445.png" alt="image-20200212225244445" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212225309569.png" alt="image-20200212225309569" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212225327440.png" alt="image-20200212225327440" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200212225350445.png" alt="image-20200212225350445" style="zoom:25%;" />

###   2-12 nginx反向代理服务器安装与配置实操 

###   2-13 nginx反向代理服务器域名解析配置实操 

 http://learning.happymmall.com/nginx/linux_conf/ 

###  2-14 nginx反向代理服务器域名解析配置细节补充-autoindex 

###  2-15 文件服务器搭建及原理讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213163016571.png" alt="image-20200213163016571" style="zoom: 33%;" />

###   2-16 mysql数据库安装与配置讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213163117290.png" alt="image-20200213163117290" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213163318454.png" alt="image-20200213163318454" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213163333738.png" alt="image-20200213163333738" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213184758683.png" alt="image-20200213184758683" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213184819438.png" alt="image-20200213184819438" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213184841491.png" alt="image-20200213184841491" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213185108114.png" alt="image-20200213185108114" style="zoom: 25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213185728390.png" alt="image-20200213185728390" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213190644220.png" alt="image-20200213190644220" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213190704846.png" alt="image-20200213190704846" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213191059666.png" alt="image-20200213191059666" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213191547978.png" alt="image-20200213191547978" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213191602993.png" alt="image-20200213191602993" style="zoom:25%;" />



<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213194045337.png" alt="image-20200213194045337" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213194110798.png" alt="image-20200213194110798" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213194129886.png" alt="image-20200213194129886" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213194154302.png" alt="image-20200213194154302" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213194221890.png" alt="image-20200213194221890" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213194242636.png" alt="image-20200213194242636" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213194302196.png" alt="image-20200213194302196" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213194318552.png" alt="image-20200213194318552" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213194338682.png" alt="image-20200213194338682" style="zoom:25%;" />



<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213192424420.png" alt="image-20200213192424420" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213192657220.png" alt="image-20200213192657220" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213192725645.png" alt="image-20200213192725645" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213192742258.png" alt="image-20200213192742258" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213192825042.png" alt="image-20200213192825042" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213192904406.png" alt="image-20200213192904406" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213192922997.png" alt="image-20200213192922997" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213192937580.png" alt="image-20200213192937580" style="zoom: 25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213192952050.png" alt="image-20200213192952050" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193007658.png" alt="image-20200213193007658" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193034862.png" alt="image-20200213193034862" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193108726.png" alt="image-20200213193108726" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193135987.png" alt="image-20200213193135987" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193256291.png" alt="image-20200213193256291" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193240569.png" alt="image-20200213193240569" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193435770.png" alt="image-20200213193435770" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193526231.png" alt="image-20200213193526231" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193546302.png" alt="image-20200213193546302" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193627223.png" alt="image-20200213193627223" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193650099.png" alt="image-20200213193650099" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193706742.png" alt="image-20200213193706742" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193725507.png" alt="image-20200213193725507" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193746486.png" alt="image-20200213193746486" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193805071.png" alt="image-20200213193805071" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193828008.png" alt="image-20200213193828008" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193843747.png" alt="image-20200213193843747" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193902477.png" alt="image-20200213193902477" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193919022.png" alt="image-20200213193919022" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193936800.png" alt="image-20200213193936800" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213193955161.png" alt="image-20200213193955161" style="zoom:25%;" />

###   2-17 mysql数据库安装与配置实操 

###  2-18 git版本控制工具安装与配置讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213201700446.png" alt="image-20200213201700446" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213201718607.png" alt="image-20200213201718607" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213201739112.png" alt="image-20200213201739112" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213202041620.png" alt="image-20200213202041620" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213202100252.png" alt="image-20200213202100252" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213202228858.png" alt="image-20200213202228858" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213202250186.png" alt="image-20200213202250186" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213202404442.png" alt="image-20200213202404442" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213202923055.png" alt="image-20200213202923055" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213202944429.png" alt="image-20200213202944429" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213203005098.png" alt="image-20200213203005098" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213203042984.png" alt="image-20200213203042984" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213212854397.png" alt="image-20200213212854397" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213213706259.png" alt="image-20200213213706259" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213213813545.png" alt="image-20200213213813545" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213213830393.png" alt="image-20200213213830393" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213213920224.png" alt="image-20200213213920224" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213213945014.png" alt="image-20200213213945014" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213214240013.png" alt="image-20200213214240013" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213214303496.png" alt="image-20200213214303496" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213214324289.png" alt="image-20200213214324289" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213214342857.png" alt="image-20200213214342857" style="zoom:50%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213214423616.png" alt="image-20200213214423616" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213214438101.png" alt="image-20200213214438101" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213214455472.png" alt="image-20200213214455472" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213214512813.png" alt="image-20200213214512813" style="zoom:25%;" />

###   2-19 git版本控制工具安装与配置实操 

# 第3章 windows系统下开发环境安装与配置指导

# 第4章 数据表结构设计（表结构，表关系，索引，时间戳）

###  4-1 数据表结构设计 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213221522224.png" alt="image-20200213221522224" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213221705750.png" alt="image-20200213221705750" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213221803231.png" alt="image-20200213221803231" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213224233159.png" alt="image-20200213224233159" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213235115764.png" alt="image-20200213235115764" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213235301657.png" alt="image-20200213235301657" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213235435902.png" alt="image-20200213235435902" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213235514894.png" alt="image-20200213235514894" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200213235544346.png" alt="image-20200213235544346" style="zoom:33%;" />

###  4-2 数据表关系设计 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214001210196.png" alt="image-20200214001210196" style="zoom:33%;" />

###  4-3 数据表索引与时间戳讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214001248895.png" alt="image-20200214001248895" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214004056644.png" alt="image-20200214004056644" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214004128803.png" alt="image-20200214004128803" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214004856393.png" alt="image-20200214004856393" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214004915875.png" alt="image-20200214004915875" style="zoom:25%;" />

# 第5章 项目初始化

###  5-1 项目初始化概要 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214005518802.png" alt="image-20200214005518802" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214005544099.png" alt="image-20200214005544099" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214005605241.png" alt="image-20200214005605241" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010124913.png" alt="image-20200214010124913" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010147855.png" alt="image-20200214010147855" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010215499.png" alt="image-20200214010215499" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010239620.png" alt="image-20200214010239620" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010309620.png" alt="image-20200214010309620" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010344865.png" alt="image-20200214010344865" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010359791.png" alt="image-20200214010359791" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010415201.png" alt="image-20200214010415201" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010428248.png" alt="image-20200214010428248" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010501722.png" alt="image-20200214010501722" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010516754.png" alt="image-20200214010516754" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010536576.png" alt="image-20200214010536576" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214010554041.png" alt="image-20200214010554041" style="zoom:25%;" />

###   5-2 数据库初始化 

###   5-3 idea项目开发工具安装实操(mac) 

###   5-4 idea项目开发工具安装实操(windows) 

###   5-5 jdk、tomcat、maven配置及初始化web空白项目 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214103352417.png" alt="image-20200214103352417" style="zoom:33%;" />

###  5-6 git初始化 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214104935277.png" alt="image-20200214104935277" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214110527377.png" alt="image-20200214110527377" style="zoom:33%;" />

```shell
*.class

#package file

*.war
*.ear

#kdiff3 ignore
*.orig

#maven ignore
target/

#eclipse ignore
.settings/
.project
.classpatch

#idea
.idea/
/idea/
*.ipr
*.iml
*.iws

# temp file

*.log
*.cache
*.diff
*.patch
*.tmp

# system ignore
.DS_Store
Thumbs.db
```

###   5-7 maven的pom文件配置 

#### 1.pom包搜索

search.maven.org

###  5-8 项目包结构初始化 

###   5-9 mybatis三剑客之mybatis-generator配置 

###  5-10 mybatis三剑客之mybatis-generator生成数据对象和时间戳优化 

###   5-11 mybatis三剑客之mybatis-plugin讲解 

###  5-12 mybatis三剑客之mybatis-pagehelper分页插件讲解 

###  5-13 spring官方demo指引及配置 

###  5-14 spring、springmvc配置实操 

###  5-15 logback配置讲解 

###  5-16 ftp服务器配置讲解

###  5-17 idea的注入和自动编译配置 

###  5-18 项目初始化代码提交

###  5-19 两个提高工作效率的神器-Restlet Client和fe助手 

# 第6章 用户模块开发

###  6-1 用户模块开发概要与接口设计讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214235540850.png" alt="image-20200214235540850" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200214235602864.png" alt="image-20200214235602864" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200215004731550.png" alt="image-20200215004731550" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200215004756983.png" alt="image-20200215004756983" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200215004901773.png" alt="image-20200215004901773" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200215004923132.png" alt="image-20200215004923132" style="zoom: 50%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200215005028259.png" alt="image-20200215005028259" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200215005133975.png" alt="image-20200215005133975" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200215010211356.png" alt="image-20200215010211356" style="zoom:25%;" />

https://gitee.com/imooccode/happymmallwiki/wikis/门户_用户接口

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200215010150159.png" alt="image-20200215010150159" style="zoom:25%;" />

https://gitee.com/imooccode/happymmallwiki/wikis/后台_用户接口)

###  6-2 登录功能开发 

响应对象

```java
package com.mmall.common;

import org.codehaus.jackson.annotate.JsonIgnore;
import org.codehaus.jackson.map.annotate.JsonSerialize;

import java.io.Serializable;

/**
 * Created by geely
 */
@JsonSerialize(include = JsonSerialize.Inclusion.NON_NULL)
//保证序列化json的时候,如果是null的对象,key也会消失
public class ServerResponse<T> implements Serializable {

    private int status;
    private String msg;
    private T data;

    private ServerResponse(int status) {
        this.status = status;
    }

    private ServerResponse(int status, T data) {
        this.status = status;
        this.data = data;
    }

    private ServerResponse(int status, String msg, T data) {
        this.status = status;
        this.msg = msg;
        this.data = data;
    }

    private ServerResponse(int status, String msg) {
        this.status = status;
        this.msg = msg;
    }

    public static <T> ServerResponse<T> createBySuccess() {
        return new ServerResponse<T>(ResponseCode.SUCCESS.getCode());
    }

    public static <T> ServerResponse<T> createBySuccessMessage(String msg) {
        return new ServerResponse<T>(ResponseCode.SUCCESS.getCode(), msg);
    }

    public static <T> ServerResponse<T> createBySuccess(T data) {
        return new ServerResponse<T>(ResponseCode.SUCCESS.getCode(), data);
    }

    public static <T> ServerResponse<T> createBySuccess(String msg, T data) {
        return new ServerResponse<T>(ResponseCode.SUCCESS.getCode(), msg, data);
    }

    public static <T> ServerResponse<T> createByError() {
        return new ServerResponse<T>(ResponseCode.ERROR.getCode(), ResponseCode.ERROR.getDesc());
    }

    public static <T> ServerResponse<T> createByErrorMessage(String errorMessage) {
        return new ServerResponse<T>(ResponseCode.ERROR.getCode(), errorMessage);
    }

    public static <T> ServerResponse<T> createByErrorCodeMessage(int errorCode, String errorMessage) {
        return new ServerResponse<T>(errorCode, errorMessage);
    }

    @JsonIgnore
    //使之不在json序列化结果当中
    public boolean isSuccess() {
        return this.status == ResponseCode.SUCCESS.getCode();
    }

    public int getStatus() {
        return status;
    }

    public T getData() {
        return data;
    }

    public String getMsg() {
        return msg;
    }
}
```

响应码

```java
package com.mmall.common;

/**
 * Created by geely
 */
public enum ResponseCode {

    SUCCESS(0, "SUCCESS"),
    ERROR(1, "ERROR"),
    NEED_LOGIN(10, "NEED_LOGIN"),
    ILLEGAL_ARGUMENT(2, "ILLEGAL_ARGUMENT");

    private final int code;
    private final String desc;


    ResponseCode(int code, String desc) {
        this.code = code;
        this.desc = desc;
    }

    public int getCode() {
        return code;
    }

    public String getDesc() {
        return desc;
    }

}
```

登录

```java
@Controller
@RequestMapping("/user/")
public class UserController {

    @Autowired
    private IUserService iUserService;

    /**
     * 用户登录
     * @param username
     * @param password
     * @param session
     * @return
     */
    @RequestMapping(value = "login.do",method = RequestMethod.POST)
    @ResponseBody
    public ServerResponse<User> login(String username, String password, HttpSession session){
        ServerResponse<User> response = iUserService.login(username,password);
        if(response.isSuccess()){
            session.setAttribute(Const.CURRENT_USER,response.getData());
        }
        return response;
    }
    
    @Override
    public ServerResponse<User> login(String username, String password) {
        int resultCount = userMapper.checkUsername(username);
        if(resultCount == 0 ){
            return ServerResponse.createByErrorMessage("用户名不存在");
        }

        String md5Password = MD5Util.MD5EncodeUtf8(password);
        User user  = userMapper.selectLogin(username,md5Password);
        if(user == null){
            return ServerResponse.createByErrorMessage("密码错误");
        }

        user.setPassword(org.apache.commons.lang3.StringUtils.EMPTY);
        return ServerResponse.createBySuccess("登录成功",user);
    }
}
```

###  6-3 登出，注册，校验功能开发 

登出

```java
    @RequestMapping(value = "logout.do",method = RequestMethod.POST)
    @ResponseBody
    public ServerResponse<String> logout(HttpSession session){
        session.removeAttribute(Const.CURRENT_USER);
        return ServerResponse.createBySuccess();
    }
```

注册

```java
    @RequestMapping(value = "register.do",method = RequestMethod.POST)
    @ResponseBody
    public ServerResponse<String> register(User user){
        return iUserService.register(user);
    }

    public ServerResponse<String> register(User user){
        ServerResponse validResponse = this.checkValid(user.getUsername(),Const.USERNAME);
        if(!validResponse.isSuccess()){
            return validResponse;
        }
        validResponse = this.checkValid(user.getEmail(),Const.EMAIL);
        if(!validResponse.isSuccess()){
            return validResponse;
        }
        user.setRole(Const.Role.ROLE_CUSTOMER);
        //MD5加密
        user.setPassword(MD5Util.MD5EncodeUtf8(user.getPassword()));
        int resultCount = userMapper.insert(user);
        if(resultCount == 0){
            return ServerResponse.createByErrorMessage("注册失败");
        }
        return ServerResponse.createBySuccessMessage("注册成功");
    }

    public ServerResponse<String> checkValid(String str,String type){
        if(org.apache.commons.lang3.StringUtils.isNotBlank(type)){
            //开始校验
            if(Const.USERNAME.equals(type)){
                int resultCount = userMapper.checkUsername(str);
                if(resultCount > 0 ){
                    return ServerResponse.createByErrorMessage("用户名已存在");
                }
            }
            if(Const.EMAIL.equals(type)){
                int resultCount = userMapper.checkEmail(str);
                if(resultCount > 0 ){
                    return ServerResponse.createByErrorMessage("email已存在");
                }
            }
        }else{
            return ServerResponse.createByErrorMessage("参数错误");
        }
        return ServerResponse.createBySuccessMessage("校验成功");
    }

    @RequestMapping(value = "check_valid.do",method = RequestMethod.POST)
    @ResponseBody
    public ServerResponse<String> checkValid(String str,String type){
        return iUserService.checkValid(str,type);
    }
```

###  6-4 获取用户登录信息，忘记密码，提示问题与答案，重置密码功能开发 

```java
    @RequestMapping(value = "get_user_info.do",method = RequestMethod.POST)
    @ResponseBody
    public ServerResponse<User> getUserInfo(HttpSession session){
        User user = (User) session.getAttribute(Const.CURRENT_USER);
        if(user != null){
            return ServerResponse.createBySuccess(user);
        }
        return ServerResponse.createByErrorMessage("用户未登录,无法获取当前用户的信息");
    }


    @RequestMapping(value = "forget_get_question.do",method = RequestMethod.POST)
    @ResponseBody
    public ServerResponse<String> forgetGetQuestion(String username){
        return iUserService.selectQuestion(username);
    }

    public ServerResponse selectQuestion(String username){
        ServerResponse validResponse = this.checkValid(username,Const.USERNAME);
        if(validResponse.isSuccess()){
            //用户不存在
            return ServerResponse.createByErrorMessage("用户不存在");
        }
        String question = userMapper.selectQuestionByUsername(username);
        if(org.apache.commons.lang3.StringUtils.isNotBlank(question)){
            return ServerResponse.createBySuccess(question);
        }
        return ServerResponse.createByErrorMessage("找回密码的问题是空的");
    }

    @RequestMapping(value = "forget_check_answer.do",method = RequestMethod.POST)
    @ResponseBody
    public ServerResponse<String> forgetCheckAnswer(String username,String question,String answer){
        return iUserService.checkAnswer(username,question,answer);
    }

    public ServerResponse<String> checkAnswer(String username, String question, String answer) {
        int resultCount = userMapper.checkAnswer(username, question, answer);
        if (resultCount > 0) {
            //说明问题及问题答案是这个用户的,并且是正确的
            String forgetToken = UUID.randomUUID().toString();
            TokenCache.setKey(TokenCache.TOKEN_PREFIX + username, forgetToken);
            return ServerResponse.createBySuccess(forgetToken);
        }
        return ServerResponse.createByErrorMessage("问题的答案错误");
    }
```

###  6-5 忘记密码中的重置密码功能开发 

```java
    @RequestMapping(value = "forget_reset_password.do",method = RequestMethod.POST)
    @ResponseBody
    public ServerResponse<String> forgetRestPassword(String username,String passwordNew,String forgetToken){
        return iUserService.forgetResetPassword(username,passwordNew,forgetToken);
    }

    public ServerResponse<String> forgetResetPassword(String username, String passwordNew, String forgetToken) {
        if (org.apache.commons.lang3.StringUtils.isBlank(forgetToken)) {
            return ServerResponse.createByErrorMessage("参数错误,token需要传递");
        }
        ServerResponse validResponse = this.checkValid(username, Const.USERNAME);
        if (validResponse.isSuccess()) {
            //用户不存在
            return ServerResponse.createByErrorMessage("用户不存在");
        }
        String token = TokenCache.getKey(TokenCache.TOKEN_PREFIX + username);
        if (org.apache.commons.lang3.StringUtils.isBlank(token)) {
            return ServerResponse.createByErrorMessage("token无效或者过期");
        }
        if (org.apache.commons.lang3.StringUtils.equals(forgetToken, token)) {
            String md5Password = MD5Util.MD5EncodeUtf8(passwordNew);
            int rowCount = userMapper.updatePasswordByUsername(username, md5Password);

            if (rowCount > 0) {
                return ServerResponse.createBySuccessMessage("修改密码成功");
            }
        } else {
            return ServerResponse.createByErrorMessage("token错误,请重新获取重置密码的token");
        }
        return ServerResponse.createByErrorMessage("修改密码失败");
    }
```

###  6-6 登录状态下重置密码功能开发 

```java
    @RequestMapping(value = "reset_password.do",method = RequestMethod.POST)
    @ResponseBody
    public ServerResponse<String> resetPassword(HttpSession session,String passwordOld,String passwordNew){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user == null){
            return ServerResponse.createByErrorMessage("用户未登录");
        }
        return iUserService.resetPassword(passwordOld,passwordNew,user);
    }

    public ServerResponse<String> resetPassword(String passwordOld, String passwordNew, User user) {
        //防止横向越权,要校验一下这个用户的旧密码,一定要指定是这个用户.因为我们会查询一个count(1),如果不指定id,那么结果就是true啦count>0;
        int resultCount = userMapper.checkPassword(MD5Util.MD5EncodeUtf8(passwordOld), user.getId());
        if (resultCount == 0) {
            return ServerResponse.createByErrorMessage("旧密码错误");
        }
        user.setPassword(MD5Util.MD5EncodeUtf8(passwordNew));
        int updateCount = userMapper.updateByPrimaryKeySelective(user);
        if (updateCount > 0) {
            return ServerResponse.createBySuccessMessage("密码更新成功");
        }
        return ServerResponse.createByErrorMessage("密码更新失败");
    }
```

###  6-7 更新用户个人信息功能开发 

```java
    @RequestMapping(value = "update_information.do",method = RequestMethod.POST)
    @ResponseBody
    public ServerResponse<User> update_information(HttpSession session,User user){
        User currentUser = (User)session.getAttribute(Const.CURRENT_USER);
        if(currentUser == null){
            return ServerResponse.createByErrorMessage("用户未登录");
        }
        user.setId(currentUser.getId());
        user.setUsername(currentUser.getUsername());
        ServerResponse<User> response = iUserService.updateInformation(user);
        if(response.isSuccess()){
            response.getData().setUsername(currentUser.getUsername());
            session.setAttribute(Const.CURRENT_USER,response.getData());
        }
        return response;
    }

    public ServerResponse<User> updateInformation(User user) {
        //username是不能被更新的
        //email也要进行一个校验,校验新的email是不是已经存在,并且存在的email如果相同的话,不能是我们当前的这个用户的.
        int resultCount = userMapper.checkEmailByUserId(user.getEmail(), user.getId());
        if (resultCount > 0) {
            return ServerResponse.createByErrorMessage("email已存在,请更换email再尝试更新");
        }
        User updateUser = new User();
        updateUser.setId(user.getId());
        updateUser.setEmail(user.getEmail());
        updateUser.setPhone(user.getPhone());
        updateUser.setQuestion(user.getQuestion());
        updateUser.setAnswer(user.getAnswer());
        int updateCount = userMapper.updateByPrimaryKeySelective(updateUser);
        if (updateCount > 0) {
            return ServerResponse.createBySuccess("更新个人信息成功", updateUser);
        }
        return ServerResponse.createByErrorMessage("更新个人信息失败");
    }
```

###  6-8 获取用户详细信息功能开发及MD5加密补充 

```java
    @RequestMapping(value = "get_information.do",method = RequestMethod.POST)
    @ResponseBody
    public ServerResponse<User> get_information(HttpSession session){
        User currentUser = (User)session.getAttribute(Const.CURRENT_USER);
        if(currentUser == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),"未登录,需要强制登录status=10");
        }
        return iUserService.getInformation(currentUser.getId());
    }

    public ServerResponse<User> getInformation(Integer userId) {
        User user = userMapper.selectByPrimaryKey(userId);
        if (user == null) {
            return ServerResponse.createByErrorMessage("找不到当前用户");
        }
        user.setPassword(org.apache.commons.lang3.StringUtils.EMPTY);
        return ServerResponse.createBySuccess(user);
    }
```

### 6-9 用户模块所有功能自测试 

# 第7章 分类管理模块开发

###  7-1 分类管理模块开发概要与接口设计讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200215215529362.png" alt="image-20200215215529362" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200215215612128.png" alt="image-20200215215612128" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200215215716137.png" alt="image-20200215215716137" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200215215837185.png" alt="image-20200215215837185" style="zoom:25%;" />

分类管理接口

https://gitee.com/imooccode/happymmallwiki/wikis/后台_品类接口

###  7-2 添加分类和更新分类名字功能开发 

```java
    @RequestMapping("add_category.do")
    @ResponseBody
    public ServerResponse addCategory(HttpSession session,String categoryName,@RequestParam(value = "parentId",defaultValue = "0") int parentId){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),"用户未登录,请登录");
        }
        //校验一下是否是管理员
        if(iUserService.checkAdminRole(user).isSuccess()){
            //是管理员
            //增加我们处理分类的逻辑
            return iCategoryService.addCategory(categoryName,parentId);
        }else{
            return ServerResponse.createByErrorMessage("无权限操作,需要管理员权限");
        }
    }

    /**
     * 校验是否是管理员
     *
     * @param user
     * @return
     */
    public ServerResponse checkAdminRole(User user) {
        if (user != null && user.getRole().intValue() == Const.Role.ROLE_ADMIN) {
            return ServerResponse.createBySuccess();
        }
        return ServerResponse.createByError();
    }

    public ServerResponse addCategory(String categoryName,Integer parentId){
        if(parentId == null || StringUtils.isBlank(categoryName)){
            return ServerResponse.createByErrorMessage("添加品类参数错误");
        }
        Category category = new Category();
        category.setName(categoryName);
        category.setParentId(parentId);
        category.setStatus(true);//这个分类是可用的
        int rowCount = categoryMapper.insert(category);
        if(rowCount > 0){
            return ServerResponse.createBySuccess("添加品类成功");
        }
        return ServerResponse.createByErrorMessage("添加品类失败");
    }
```

```java
    @RequestMapping("set_category_name.do")
    @ResponseBody
    public ServerResponse setCategoryName(HttpSession session,Integer categoryId,String categoryName){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),"用户未登录,请登录");
        }
        if(iUserService.checkAdminRole(user).isSuccess()){
            //更新categoryName
            return iCategoryService.updateCategoryName(categoryId,categoryName);
        }else{
            return ServerResponse.createByErrorMessage("无权限操作,需要管理员权限");
        }
    }
```

###  7-3 查询节点和递归查找功能开发 

```java
    @RequestMapping("get_category.do")
    @ResponseBody
    public ServerResponse getChildrenParallelCategory(HttpSession session, @RequestParam(value = "categoryId", defaultValue = "0") Integer categoryId) {
        User user = (User) session.getAttribute(Const.CURRENT_USER);
        if (user == null) {
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(), "用户未登录,请登录");
        }
        if (iUserService.checkAdminRole(user).isSuccess()) {
            //查询子节点的category信息,并且不递归,保持平级
            return iCategoryService.getChildrenParallelCategory(categoryId);
        } else {
            return ServerResponse.createByErrorMessage("无权限操作,需要管理员权限");
        }
    }

    public ServerResponse<List<Category>> getChildrenParallelCategory(Integer categoryId) {
        List<Category> categoryList = categoryMapper.selectCategoryChildrenByParentId(categoryId);
        if (CollectionUtils.isEmpty(categoryList)) {
            logger.info("未找到当前分类的子分类");
        }
        return ServerResponse.createBySuccess(categoryList);
    }
```

```java
    @RequestMapping("get_deep_category.do")
    @ResponseBody
    public ServerResponse getCategoryAndDeepChildrenCategory(HttpSession session, @RequestParam(value = "categoryId", defaultValue = "0") Integer categoryId) {
        User user = (User) session.getAttribute(Const.CURRENT_USER);
        if (user == null) {
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(), "用户未登录,请登录");
        }
        if (iUserService.checkAdminRole(user).isSuccess()) {
            // 查询当前节点的id和递归子节点的id
            // 0->10000->100000
            return iCategoryService.selectCategoryAndChildrenById(categoryId);

        } else {
            return ServerResponse.createByErrorMessage("无权限操作,需要管理员权限");
        }
    }

    /**
     * 递归查询本节点的id及孩子节点的id
     *
     * @param categoryId
     * @return
     */
    public ServerResponse<List<Integer>> selectCategoryAndChildrenById(Integer categoryId) {
        Set<Category> categorySet = Sets.newHashSet();
        findChildCategory(categorySet, categoryId);
        List<Integer> categoryIdList = Lists.newArrayList();
        if (categoryId != null) {
            for (Category categoryItem : categorySet) {
                categoryIdList.add(categoryItem.getId());
            }
        }
        return ServerResponse.createBySuccess(categoryIdList);
    }
```

###  7-4 分类管理模块所有功能自测 

# 第8章 商品管理模块开发

###  8-1 商品管理模块开发概要与接口设计讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216001922427.png" alt="image-20200216001922427" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216001944327.png" alt="image-20200216001944327" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216002005740.png" alt="image-20200216002005740" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216002038134.png" alt="image-20200216002038134" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216002527924.png" alt="image-20200216002527924" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216002541798.png" alt="image-20200216002541798" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216003325925.png" alt="image-20200216003325925" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216003415138.png" alt="image-20200216003415138" style="zoom:25%;" />

https://gitee.com/imooccode/happymmallwiki/wikis/门户_产品接口

###  8-2 后台商品新增，保存，更新，上下架功能开发 

```java
    @RequestMapping("save.do")
    @ResponseBody
    public ServerResponse productSave(HttpSession session, Product product){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),"用户未登录,请登录管理员");
        }
        if(iUserService.checkAdminRole(user).isSuccess()){
            //填充我们增加产品的业务逻辑
            return iProductService.saveOrUpdateProduct(product);
        }else{
            return ServerResponse.createByErrorMessage("无权限操作");
        }
    }

    /**
     * 校验是否是管理员
     *
     * @param user
     * @return
     */
    public ServerResponse checkAdminRole(User user) {
        if (user != null && user.getRole().intValue() == Const.Role.ROLE_ADMIN) {
            return ServerResponse.createBySuccess();
        }
        return ServerResponse.createByError();
    }

    public ServerResponse saveOrUpdateProduct(Product product){
        if(product != null)
        {
            if(StringUtils.isNotBlank(product.getSubImages())){
                String[] subImageArray = product.getSubImages().split(",");
                if(subImageArray.length > 0){
                    product.setMainImage(subImageArray[0]);
                }
            }
            if(product.getId() != null){
                int rowCount = productMapper.updateByPrimaryKey(product);
                if(rowCount > 0){
                    return ServerResponse.createBySuccess("更新产品成功");
                }
                return ServerResponse.createBySuccess("更新产品失败");
            }else{
                int rowCount = productMapper.insert(product);
                if(rowCount > 0){
                    return ServerResponse.createBySuccess("新增产品成功");
                }
                return ServerResponse.createBySuccess("新增产品失败");
            }
        }
        return ServerResponse.createByErrorMessage("新增或更新产品参数不正确");
    }
```

```java
    @RequestMapping("set_sale_status.do")
    @ResponseBody
    public ServerResponse setSaleStatus(HttpSession session, Integer productId,Integer status){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),"用户未登录,请登录管理员");
        }
        if(iUserService.checkAdminRole(user).isSuccess()){
            return iProductService.setSaleStatus(productId,status);
        }else{
            return ServerResponse.createByErrorMessage("无权限操作");
        }
    }

    public ServerResponse<String> setSaleStatus(Integer productId,Integer status){
        if(productId == null || status == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.ILLEGAL_ARGUMENT.getCode(),ResponseCode.ILLEGAL_ARGUMENT.getDesc());
        }
        Product product = new Product();
        product.setId(productId);
        product.setStatus(status);
        int rowCount = productMapper.updateByPrimaryKeySelective(product);
        if(rowCount > 0){
            return ServerResponse.createBySuccess("修改产品销售状态成功");
        }
        return ServerResponse.createByErrorMessage("修改产品销售状态失败");
    }
```

###  8-3 后台获取商品详情功能开发及PropertiesUtil配置工具，DateTimeUtil时间处理工具开发 

```java
    @RequestMapping("detail.do")
    @ResponseBody
    public ServerResponse getDetail(HttpSession session, Integer productId){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),"用户未登录,请登录管理员");

        }
        if(iUserService.checkAdminRole(user).isSuccess()){
            //填充业务
            return iProductService.manageProductDetail(productId);

        }else{
            return ServerResponse.createByErrorMessage("无权限操作");
        }
    }

    public ServerResponse<ProductDetailVo> manageProductDetail(Integer productId){
        if(productId == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.ILLEGAL_ARGUMENT.getCode(),ResponseCode.ILLEGAL_ARGUMENT.getDesc());
        }
        Product product = productMapper.selectByPrimaryKey(productId);
        if(product == null){
            return ServerResponse.createByErrorMessage("产品已下架或者删除");
        }
        ProductDetailVo productDetailVo = assembleProductDetailVo(product);
        return ServerResponse.createBySuccess(productDetailVo);
    }

    private ProductDetailVo assembleProductDetailVo(Product product) {
        ProductDetailVo productDetailVo = new ProductDetailVo();
        productDetailVo.setId(product.getId());
        productDetailVo.setSubtitle(product.getSubtitle());
        productDetailVo.setPrice(product.getPrice());
        productDetailVo.setMainImage(product.getMainImage());
        productDetailVo.setSubImages(product.getSubImages());
        productDetailVo.setCategoryId(product.getCategoryId());
        productDetailVo.setDetail(product.getDetail());
        productDetailVo.setName(product.getName());
        productDetailVo.setStatus(product.getStatus());
        productDetailVo.setStock(product.getStock());
        productDetailVo.setImageHost(PropertiesUtil.getProperty("ftp.server.http.prefix", "http://img.happymmall.com/"));
        Category category = categoryMapper.selectByPrimaryKey(product.getCategoryId());
        if (category == null) {
            productDetailVo.setParentCategoryId(0);//默认根节点
        } else {
            productDetailVo.setParentCategoryId(category.getParentId());
        }
        productDetailVo.setCreateTime(DateTimeUtil.dateToStr(product.getCreateTime()));
        productDetailVo.setUpdateTime(DateTimeUtil.dateToStr(product.getUpdateTime()));
        return productDetailVo;
    }
```

静态代码块流读取配置文件

```java
public class PropertiesUtil {

    private static Logger logger = LoggerFactory.getLogger(PropertiesUtil.class);

    private static Properties props;

    static {
        String fileName = "mmall.properties";
        props = new Properties();
        try {
            props.load(new InputStreamReader(PropertiesUtil.class.getClassLoader().getResourceAsStream(fileName),"UTF-8"));
        } catch (IOException e) {
            logger.error("配置文件读取异常",e);
        }
    }

    public static String getProperty(String key){
        String value = props.getProperty(key.trim());
        if(StringUtils.isBlank(value)){
            return null;
        }
        return value.trim();
    }

    public static String getProperty(String key,String defaultValue){
        String value = props.getProperty(key.trim());
        if(StringUtils.isBlank(value)){
            value = defaultValue;
        }
        return value.trim();
    }
}
```

###  8-4 后台商品列表动态分页功能开发 

```java
    @RequestMapping("list.do")
    @ResponseBody
    public ServerResponse getList(HttpSession session, @RequestParam(value = "pageNum",defaultValue = "1") int pageNum,@RequestParam(value = "pageSize",defaultValue = "10") int pageSize){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),"用户未登录,请登录管理员");
        }
        if(iUserService.checkAdminRole(user).isSuccess()){
            //填充业务
            return iProductService.getProductList(pageNum,pageSize);
        }else{
            return ServerResponse.createByErrorMessage("无权限操作");
        }
    }

    public ServerResponse<PageInfo> getProductList(int pageNum, int pageSize) {
        //startPage--start
        //填充自己的sql查询逻辑
        //pageHelper-收尾
        PageHelper.startPage(pageNum, pageSize);
        List<Product> productList = productMapper.selectList();
        List<ProductListVo> productListVoList = Lists.newArrayList();
        for (Product productItem : productList) {
            ProductListVo productListVo = assembleProductListVo(productItem);
            productListVoList.add(productListVo);
        }
        PageInfo pageResult = new PageInfo(productList);
        pageResult.setList(productListVoList);
        return ServerResponse.createBySuccess(pageResult);
    }

    private ProductListVo assembleProductListVo(Product product) {
        ProductListVo productListVo = new ProductListVo();
        productListVo.setId(product.getId());
        productListVo.setName(product.getName());
        productListVo.setCategoryId(product.getCategoryId());
        productListVo.setImageHost(PropertiesUtil.getProperty("ftp.server.http.prefix", "http://img.happymmall.com/"));
        productListVo.setMainImage(product.getMainImage());
        productListVo.setPrice(product.getPrice());
        productListVo.setSubtitle(product.getSubtitle());
        productListVo.setStatus(product.getStatus());
        return productListVo;
    }
```

###  8-5 后台商品搜索功能开发 

```java
    @RequestMapping("search.do")
    @ResponseBody
    public ServerResponse productSearch(HttpSession session,String productName,Integer productId, @RequestParam(value = "pageNum",defaultValue = "1") int pageNum,@RequestParam(value = "pageSize",defaultValue = "10") int pageSize){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),"用户未登录,请登录管理员");
        }
        if(iUserService.checkAdminRole(user).isSuccess()){
            //填充业务
            return iProductService.searchProduct(productName,productId,pageNum,pageSize);
        }else{
            return ServerResponse.createByErrorMessage("无权限操作");
        }
    }

    public ServerResponse<PageInfo> searchProduct(String productName, Integer productId, int pageNum, int pageSize) {
        PageHelper.startPage(pageNum, pageSize);
        if (StringUtils.isNotBlank(productName)) {
            productName = new StringBuilder().append("%").append(productName).append("%").toString();
        }
        List<Product> productList = productMapper.selectByNameAndProductId(productName, productId);
        List<ProductListVo> productListVoList = Lists.newArrayList();
        for (Product productItem : productList) {
            ProductListVo productListVo = assembleProductListVo(productItem);
            productListVoList.add(productListVo);
        }
        PageInfo pageResult = new PageInfo(productList);
        pageResult.setList(productListVoList);
        return ServerResponse.createBySuccess(pageResult);
    }
```

###  8-6 后台商品图片的springmvc上传与富文本上传ftp服务器功能开发1 

文件上传

```java
@Service("iFileService")
public class FileServiceImpl implements IFileService {

    private Logger logger = LoggerFactory.getLogger(FileServiceImpl.class);

    public String upload(MultipartFile file,String path){
        String fileName = file.getOriginalFilename();
        //扩展名
        //abc.jpg
        String fileExtensionName = fileName.substring(fileName.lastIndexOf(".")+1);
        String uploadFileName = UUID.randomUUID().toString()+"."+fileExtensionName;
        logger.info("开始上传文件,上传文件的文件名:{},上传的路径:{},新文件名:{}",fileName,path,uploadFileName);
        File fileDir = new File(path);
        if(!fileDir.exists()){
            fileDir.setWritable(true);
            fileDir.mkdirs();
        }
        File targetFile = new File(path,uploadFileName);
        try {
            file.transferTo(targetFile);
            //文件已经上传成功了
            FTPUtil.uploadFile(Lists.newArrayList(targetFile));
            //已经上传到ftp服务器上
            targetFile.delete();
        } catch (IOException e) {
            logger.error("上传文件异常",e);
            return null;
        }
        //A:abc.jpg
        //B:abc.jpg
        return targetFile.getName();
    }
}
```

###  8-7 后台商品图片的springmvc上传与富文本上传ftp服务器功能开发2 

FTPUtil

```java
public class FTPUtil {

    private static  final Logger logger = LoggerFactory.getLogger(FTPUtil.class);

    private static String ftpIp = PropertiesUtil.getProperty("ftp.server.ip");
    private static String ftpUser = PropertiesUtil.getProperty("ftp.user");
    private static String ftpPass = PropertiesUtil.getProperty("ftp.pass");

    public FTPUtil(String ip,int port,String user,String pwd){
        this.ip = ip;
        this.port = port;
        this.user = user;
        this.pwd = pwd;
    }
    
    public static boolean uploadFile(List<File> fileList) throws IOException {
        FTPUtil ftpUtil = new FTPUtil(ftpIp,21,ftpUser,ftpPass);
        logger.info("开始连接ftp服务器");
        boolean result = ftpUtil.uploadFile("img",fileList);
        logger.info("开始连接ftp服务器,结束上传,上传结果:{}");
        return result;
    }

    private boolean uploadFile(String remotePath,List<File> fileList) throws IOException {
        boolean uploaded = true;
        FileInputStream fis = null;
        //连接FTP服务器
        if(connectServer(this.ip,this.port,this.user,this.pwd)){
            try {
                ftpClient.changeWorkingDirectory(remotePath);
                ftpClient.setBufferSize(1024);
                ftpClient.setControlEncoding("UTF-8");
                ftpClient.setFileType(FTPClient.BINARY_FILE_TYPE);
                ftpClient.enterLocalPassiveMode();
                for(File fileItem : fileList){
                    fis = new FileInputStream(fileItem);
                    ftpClient.storeFile(fileItem.getName(),fis);
                }

            } catch (IOException e) {
                logger.error("上传文件异常",e);
                uploaded = false;
                e.printStackTrace();
            } finally {
                fis.close();
                ftpClient.disconnect();
            }
        }
        return uploaded;
    }

    private boolean connectServer(String ip,int port,String user,String pwd){
        boolean isSuccess = false;
        ftpClient = new FTPClient();
        try {
            ftpClient.connect(ip);
            isSuccess = ftpClient.login(user,pwd);
        } catch (IOException e) {
            logger.error("连接FTP服务器异常",e);
        }
        return isSuccess;
    }

    private String ip;
    private int port;
    private String user;
    private String pwd;
    private FTPClient ftpClient;
}
```

控制层

```java
    @RequestMapping("upload.do")
    @ResponseBody
    public ServerResponse upload(HttpSession session, @RequestParam(value = "upload_file", required = false) MultipartFile file, HttpServletRequest request) {
        User user = (User) session.getAttribute(Const.CURRENT_USER);
        if (user == null) {
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(), "用户未登录,请登录管理员");
        }
        if (iUserService.checkAdminRole(user).isSuccess()) {
            String path = request.getSession().getServletContext().getRealPath("upload");
            String targetFileName = iFileService.upload(file, path);
            String url = PropertiesUtil.getProperty("ftp.server.http.prefix") + targetFileName;
            Map fileMap = Maps.newHashMap();
            fileMap.put("uri", targetFileName);
            fileMap.put("url", url);
            return ServerResponse.createBySuccess(fileMap);
        } else {
            return ServerResponse.createByErrorMessage("无权限操作");
        }
    }
```

富文本上传
```java
    @RequestMapping("richtext_img_upload.do")
    @ResponseBody
    public Map richtextImgUpload(HttpSession session, @RequestParam(value = "upload_file", required = false) MultipartFile file, HttpServletRequest request, HttpServletResponse response) {
        Map resultMap = Maps.newHashMap();
        User user = (User) session.getAttribute(Const.CURRENT_USER);
        if (user == null) {
            resultMap.put("success", false);
            resultMap.put("msg", "请登录管理员");
            return resultMap;
        }
        // 富文本中对于返回值有自己的要求,我们使用是simditor所以按照simditor的要求进行返回
        // {
        //     "success": true/false,
        //         "msg": "error message", # optional
        //     "file_path": "[real file path]"
        // }
        if (iUserService.checkAdminRole(user).isSuccess()) {
            String path = request.getSession().getServletContext().getRealPath("upload");
            String targetFileName = iFileService.upload(file, path);
            if (StringUtils.isBlank(targetFileName)) {
                resultMap.put("success", false);
                resultMap.put("msg", "上传失败");
                return resultMap;
            }
            String url = PropertiesUtil.getProperty("ftp.server.http.prefix") + targetFileName;
            resultMap.put("success", true);
            resultMap.put("msg", "上传成功");
            resultMap.put("file_path", url);
            response.addHeader("Access-Control-Allow-Headers", "X-File-Name");
            return resultMap;
        } else {
            resultMap.put("success", false);
            resultMap.put("msg", "无权限操作");
            return resultMap;
        }
    }
```

###  8-8 前台商品详情，列表，搜索，动态排序功能开发 

```java
    @RequestMapping("detail.do")
    @ResponseBody
    public ServerResponse<ProductDetailVo> detail(Integer productId){
        return iProductService.getProductDetail(productId);
    }

    public ServerResponse<ProductDetailVo> getProductDetail(Integer productId) {
        if (productId == null) {
            return ServerResponse.createByErrorCodeMessage(ResponseCode.ILLEGAL_ARGUMENT.getCode(), ResponseCode.ILLEGAL_ARGUMENT.getDesc());
        }
        Product product = productMapper.selectByPrimaryKey(productId);
        if (product == null) {
            return ServerResponse.createByErrorMessage("产品已下架或者删除");
        }
        if (product.getStatus() != Const.ProductStatusEnum.ON_SALE.getCode()) {
            return ServerResponse.createByErrorMessage("产品已下架或者删除");
        }
        ProductDetailVo productDetailVo = assembleProductDetailVo(product);
        return ServerResponse.createBySuccess(productDetailVo);
    }
```

```java
    @RequestMapping("list.do")
    @ResponseBody
    public ServerResponse<PageInfo> list(@RequestParam(value = "keyword", required = false) String keyword,
                                         @RequestParam(value = "categoryId", required = false) Integer categoryId,
                                         @RequestParam(value = "pageNum", defaultValue = "1") int pageNum,
                                         @RequestParam(value = "pageSize", defaultValue = "10") int pageSize,
                                         @RequestParam(value = "orderBy", defaultValue = "") String orderBy) {
        return iProductService.getProductByKeywordCategory(keyword, categoryId, pageNum, pageSize, orderBy);
    }

    public ServerResponse<PageInfo> getProductByKeywordCategory(String keyword, Integer categoryId, int pageNum, int pageSize, String orderBy) {
        if (StringUtils.isBlank(keyword) && categoryId == null) {
            return ServerResponse.createByErrorCodeMessage(ResponseCode.ILLEGAL_ARGUMENT.getCode(), ResponseCode.ILLEGAL_ARGUMENT.getDesc());
        }
        List<Integer> categoryIdList = new ArrayList<Integer>();
        if (categoryId != null) {
            Category category = categoryMapper.selectByPrimaryKey(categoryId);
            if (category == null && StringUtils.isBlank(keyword)) {
                //没有该分类,并且还没有关键字,这个时候返回一个空的结果集,不报错
                PageHelper.startPage(pageNum, pageSize);
                List<ProductListVo> productListVoList = Lists.newArrayList();
                PageInfo pageInfo = new PageInfo(productListVoList);
                return ServerResponse.createBySuccess(pageInfo);
            }
            categoryIdList = iCategoryService.selectCategoryAndChildrenById(category.getId()).getData();
        }
        if (StringUtils.isNotBlank(keyword)) {
            keyword = new StringBuilder().append("%").append(keyword).append("%").toString();
        }
        PageHelper.startPage(pageNum, pageSize);
        //排序处理
        if (StringUtils.isNotBlank(orderBy)) {
            if (Const.ProductListOrderBy.PRICE_ASC_DESC.contains(orderBy)) {
                String[] orderByArray = orderBy.split("_");
                PageHelper.orderBy(orderByArray[0] + " " + orderByArray[1]);
            }
        }
        List<Product> productList = productMapper.selectByNameAndCategoryIds(StringUtils.isBlank(keyword) ? null : keyword, categoryIdList.size() == 0 ? null : categoryIdList);
        List<ProductListVo> productListVoList = Lists.newArrayList();
        for (Product product : productList) {
            ProductListVo productListVo = assembleProductListVo(product);
            productListVoList.add(productListVo);
        }
        PageInfo pageInfo = new PageInfo(productList);
        pageInfo.setList(productListVoList);
        return ServerResponse.createBySuccess(pageInfo);
    }
```

###  8-9 商品管理模块所有功能自测  

# 第9章 购物车模块开发

###  9-1 购物车模块开发概要与接口设计讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216150825881.png" alt="image-20200216150825881" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216150958271.png" alt="image-20200216150958271" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216151046157.png" alt="image-20200216151046157" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216151103187.png" alt="image-20200216151103187" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216152204668.png" alt="image-20200216152204668" style="zoom:33%;" />

###  9-2 加入购物车功能开发1 

```java
    @RequestMapping("add.do")
    @ResponseBody
    public ServerResponse<CartVo> add(HttpSession session, Integer count, Integer productId){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iCartService.add(user.getId(),productId,count);
    }

    public ServerResponse<CartVo> add(Integer userId, Integer productId, Integer count) {
        if (productId == null || count == null) {
            return ServerResponse.createByErrorCodeMessage(ResponseCode.ILLEGAL_ARGUMENT.getCode(), ResponseCode.ILLEGAL_ARGUMENT.getDesc());
        }
        Cart cart = cartMapper.selectCartByUserIdProductId(userId, productId);
        if (cart == null) {
            //这个产品不在这个购物车里,需要新增一个这个产品的记录
            Cart cartItem = new Cart();
            cartItem.setQuantity(count);
            cartItem.setChecked(Const.Cart.CHECKED);
            cartItem.setProductId(productId);
            cartItem.setUserId(userId);
            cartMapper.insert(cartItem);
        } else {
            //这个产品已经在购物车里了.
            //如果产品已存在,数量相加
            count = cart.getQuantity() + count;
            cart.setQuantity(count);
            cartMapper.updateByPrimaryKeySelective(cart);
        }
        return this.list(userId);
    }
```

###  9-3 加入购物车功能开发2 

BigDecimal工具类

```java
public class BigDecimalUtil {

    private BigDecimalUtil(){
    }
    
    public static BigDecimal add(double v1,double v2){
        BigDecimal b1 = new BigDecimal(Double.toString(v1));
        BigDecimal b2 = new BigDecimal(Double.toString(v2));
        return b1.add(b2);
    }

    public static BigDecimal sub(double v1,double v2){
        BigDecimal b1 = new BigDecimal(Double.toString(v1));
        BigDecimal b2 = new BigDecimal(Double.toString(v2));
        return b1.subtract(b2);
    }    

    public static BigDecimal mul(double v1,double v2){
        BigDecimal b1 = new BigDecimal(Double.toString(v1));
        BigDecimal b2 = new BigDecimal(Double.toString(v2));
        return b1.multiply(b2);
    }

    public static BigDecimal div(double v1,double v2){
        BigDecimal b1 = new BigDecimal(Double.toString(v1));
        BigDecimal b2 = new BigDecimal(Double.toString(v2));
        return b1.divide(b2,2,BigDecimal.ROUND_HALF_UP);//四舍五入,保留2位小数
        //除不尽的情况
    }
}
```

```java
    @RequestMapping("list.do")
    @ResponseBody
    public ServerResponse<CartVo> list(HttpSession session){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iCartService.list(user.getId());
    }    

	public ServerResponse<CartVo> list(Integer userId) {
        CartVo cartVo = this.getCartVoLimit(userId);
        return ServerResponse.createBySuccess(cartVo);
    }    

    private CartVo getCartVoLimit(Integer userId) {
        CartVo cartVo = new CartVo();
        List<Cart> cartList = cartMapper.selectCartByUserId(userId);
        List<CartProductVo> cartProductVoList = Lists.newArrayList();
        BigDecimal cartTotalPrice = new BigDecimal("0");
        if (CollectionUtils.isNotEmpty(cartList)) {
            for (Cart cartItem : cartList) {
                CartProductVo cartProductVo = new CartProductVo();
                cartProductVo.setId(cartItem.getId());
                cartProductVo.setUserId(userId);
                cartProductVo.setProductId(cartItem.getProductId());
                Product product = productMapper.selectByPrimaryKey(cartItem.getProductId());
                if (product != null) {
                    cartProductVo.setProductMainImage(product.getMainImage());
                    cartProductVo.setProductName(product.getName());
                    cartProductVo.setProductSubtitle(product.getSubtitle());
                    cartProductVo.setProductStatus(product.getStatus());
                    cartProductVo.setProductPrice(product.getPrice());
                    cartProductVo.setProductStock(product.getStock());
                    //判断库存
                    int buyLimitCount = 0;
                    if (product.getStock() >= cartItem.getQuantity()) {
                        //库存充足的时候
                        buyLimitCount = cartItem.getQuantity();
                        cartProductVo.setLimitQuantity(Const.Cart.LIMIT_NUM_SUCCESS);
                    } else {
                        buyLimitCount = product.getStock();
                        cartProductVo.setLimitQuantity(Const.Cart.LIMIT_NUM_FAIL);
                        //购物车中更新有效库存
                        Cart cartForQuantity = new Cart();
                        cartForQuantity.setId(cartItem.getId());
                        cartForQuantity.setQuantity(buyLimitCount);
                        cartMapper.updateByPrimaryKeySelective(cartForQuantity);
                    }
                    cartProductVo.setQuantity(buyLimitCount);
                    //计算总价
                    cartProductVo.setProductTotalPrice(BigDecimalUtil.mul(product.getPrice().doubleValue(), cartProductVo.getQuantity()));
                    cartProductVo.setProductChecked(cartItem.getChecked());
                }
                if (cartItem.getChecked() == Const.Cart.CHECKED) {
                    //如果已经勾选,增加到整个的购物车总价中
                    cartTotalPrice = BigDecimalUtil.add(cartTotalPrice.doubleValue(), cartProductVo.getProductTotalPrice().doubleValue());
                }
                cartProductVoList.add(cartProductVo);
            }
        }
        cartVo.setCartTotalPrice(cartTotalPrice);
        cartVo.setCartProductVoList(cartProductVoList);
        cartVo.setAllChecked(this.getAllCheckedStatus(userId));
        cartVo.setImageHost(PropertiesUtil.getProperty("ftp.server.http.prefix"));
        return cartVo;
    }

    private boolean getAllCheckedStatus(Integer userId) {
        if (userId == null) {
            return false;
        }
        return cartMapper.selectCartProductCheckedStatusByUserId(userId) == 0;
    }
```

###  9-4 更新，删除购物车商品功能开发 

```java
    @RequestMapping("update.do")
    @ResponseBody
    public ServerResponse<CartVo> update(HttpSession session, Integer count, Integer productId){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iCartService.update(user.getId(),productId,count);
    }

    public ServerResponse<CartVo> update(Integer userId, Integer productId, Integer count) {
        if (productId == null || count == null) {
            return ServerResponse.createByErrorCodeMessage(ResponseCode.ILLEGAL_ARGUMENT.getCode(), ResponseCode.ILLEGAL_ARGUMENT.getDesc());
        }
        Cart cart = cartMapper.selectCartByUserIdProductId(userId, productId);
        if (cart != null) {
            cart.setQuantity(count);
        }
        cartMapper.updateByPrimaryKey(cart);
        return this.list(userId);
    }
```

```java
    @RequestMapping("delete_product.do")
    @ResponseBody
    public ServerResponse<CartVo> deleteProduct(HttpSession session,String productIds){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iCartService.deleteProduct(user.getId(),productIds);
    }

    public ServerResponse<CartVo> deleteProduct(Integer userId, String productIds) {
        List<String> productList = Splitter.on(",").splitToList(productIds);
        if (CollectionUtils.isEmpty(productList)) {
            return ServerResponse.createByErrorCodeMessage(ResponseCode.ILLEGAL_ARGUMENT.getCode(), ResponseCode.ILLEGAL_ARGUMENT.getDesc());
        }
        cartMapper.deleteByUserIdProductIds(userId, productList);
        return this.list(userId);
    }
```

###  9-5 全选，全反选，单选，单反选，查询购物车商品数量功能开发 

```java
   @RequestMapping("select_all.do")
    @ResponseBody
    public ServerResponse<CartVo> selectAll(HttpSession session){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iCartService.selectOrUnSelect(user.getId(),null,Const.Cart.CHECKED);
    }

    @RequestMapping("un_select_all.do")
    @ResponseBody
    public ServerResponse<CartVo> unSelectAll(HttpSession session){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iCartService.selectOrUnSelect(user.getId(),null,Const.Cart.UN_CHECKED);
    }

    @RequestMapping("select.do")
    @ResponseBody
    public ServerResponse<CartVo> select(HttpSession session,Integer productId){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iCartService.selectOrUnSelect(user.getId(),productId,Const.Cart.CHECKED);
    }

    @RequestMapping("un_select.do")
    @ResponseBody
    public ServerResponse<CartVo> unSelect(HttpSession session,Integer productId){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iCartService.selectOrUnSelect(user.getId(),productId,Const.Cart.UN_CHECKED);
    }

    public ServerResponse<CartVo> selectOrUnSelect(Integer userId, Integer productId, Integer checked) {
        cartMapper.checkedOrUncheckedProduct(userId, productId, checked);
        return this.list(userId);
    }
```

```java
    @RequestMapping("get_cart_product_count.do")
    @ResponseBody
    public ServerResponse<Integer> getCartProductCount(HttpSession session){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createBySuccess(0);
        }
        return iCartService.getCartProductCount(user.getId());
    }

    public ServerResponse<Integer> getCartProductCount(Integer userId) {
        if (userId == null) {
            return ServerResponse.createBySuccess(0);
        }
        return ServerResponse.createBySuccess(cartMapper.selectCartProductCount(userId));
    }
```

###  9-6 购物车模块所有功能自测 

# 第10章 收货地址管理模块开发

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216173209503.png" alt="image-20200216173209503" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216173328325.png" alt="image-20200216173328325" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216173347843.png" alt="image-20200216173347843" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216173412188.png" alt="image-20200216173412188" style="zoom:33%;" />

###  10-2 收货地址增，删，改，查，分页列表，地址详情功能开发 

```java
    @RequestMapping("add.do")
    @ResponseBody
    public ServerResponse add(HttpSession session,Shipping shipping){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iShippingService.add(user.getId(),shipping);
    }

    public ServerResponse add(Integer userId, Shipping shipping){
        shipping.setUserId(userId);
        int rowCount = shippingMapper.insert(shipping);
        if(rowCount > 0){
            Map result = Maps.newHashMap();
            result.put("shippingId",shipping.getId());
            return ServerResponse.createBySuccess("新建地址成功",result);
        }
        return ServerResponse.createByErrorMessage("新建地址失败");
    }
```

```java
    @RequestMapping("del.do")
    @ResponseBody
    public ServerResponse del(HttpSession session,Integer shippingId){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iShippingService.del(user.getId(),shippingId);
    }

    public ServerResponse<String> del(Integer userId,Integer shippingId){
        int resultCount = shippingMapper.deleteByShippingIdUserId(userId,shippingId);
        if(resultCount > 0){
            return ServerResponse.createBySuccess("删除地址成功");
        }
        return ServerResponse.createByErrorMessage("删除地址失败");
    }
```

```java
    @RequestMapping("select.do")
    @ResponseBody
    public ServerResponse<Shipping> select(HttpSession session,Integer shippingId){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iShippingService.select(user.getId(),shippingId);
    }

    public ServerResponse<Shipping> select(Integer userId, Integer shippingId){
        Shipping shipping = shippingMapper.selectByShippingIdUserId(userId,shippingId);
        if(shipping == null){
            return ServerResponse.createByErrorMessage("无法查询到该地址");
        }
        return ServerResponse.createBySuccess("更新地址成功",shipping);
    }
```

```java
    @RequestMapping("list.do")
    @ResponseBody
    public ServerResponse<PageInfo> list(@RequestParam(value = "pageNum",defaultValue = "1") int pageNum,
                                         @RequestParam(value = "pageSize",defaultValue = "10")int pageSize,
                                         HttpSession session){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iShippingService.list(user.getId(),pageNum,pageSize);
    }

    public ServerResponse<PageInfo> list(Integer userId,int pageNum,int pageSize){
        PageHelper.startPage(pageNum,pageSize);
        List<Shipping> shippingList = shippingMapper.selectByUserId(userId);
        PageInfo pageInfo = new PageInfo(shippingList);
        return ServerResponse.createBySuccess(pageInfo);
    }
```

# 第11章 支付模块开发

###  11-1 支付模块开发概要与接口设计讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216211843597.png" alt="image-20200216211843597" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216211956286.png" alt="image-20200216211956286" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216212014726.png" alt="image-20200216212014726" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216212045951.png" alt="image-20200216212045951" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216212239109.png" alt="image-20200216212239109" style="zoom:25%;" />

https://gitee.com/imooccode/happymmallwiki/wikis/门户_支付接口

###  11-2 支付宝支付功能对接要点讲解(知识点补充) 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216225242541.png" alt="image-20200216225242541" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216225410968.png" alt="image-20200216225410968" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216225428653.png" alt="image-20200216225428653" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216225508674.png" alt="image-20200216225508674" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216225537954.png" alt="image-20200216225537954" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216225602331.png" alt="image-20200216225602331" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216225653074.png" alt="image-20200216225653074" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216225720950.png" alt="image-20200216225720950" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216225857890.png" alt="image-20200216225857890" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216225929452.png" alt="image-20200216225929452" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216230145651.png" alt="image-20200216230145651" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216230614499.png" alt="image-20200216230614499" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216235059286.png" alt="image-20200216235059286" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216235308734.png" alt="image-20200216235308734" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216235502998.png" alt="image-20200216235502998" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216235540537.png" alt="image-20200216235540537" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200216235557095.png" alt="image-20200216235557095" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217000003748.png" alt="image-20200217000003748" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217000027095.png" alt="image-20200217000027095" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217001602096.png" alt="image-20200217001602096" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217001646001.png" alt="image-20200217001646001" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217001705612.png" alt="image-20200217001705612" style="zoom: 33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217001729893.png" alt="image-20200217001729893" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217001745257.png" alt="image-20200217001745257" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217001855396.png" alt="image-20200217001855396" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217001919438.png" alt="image-20200217001919438" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217001939407.png" alt="image-20200217001939407" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217001954175.png" alt="image-20200217001954175" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217002012028.png" alt="image-20200217002012028" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217002026507.png" alt="image-20200217002026507" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217002039060.png" alt="image-20200217002039060" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217002052070.png" alt="image-20200217002052070" style="zoom: 25%;" />

###  11-3 支付宝支付功能重要文档简介(知识点补充) 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217165554173.png" alt="image-20200217165554173" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217165859170.png" alt="image-20200217165859170" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217165952526.png" alt="image-20200217165952526" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217170023225.png" alt="image-20200217170023225" style="zoom:25%;" />

###  11-4 支付宝支付功能官方Demo调试实操1(知识点补充) 

###  11-5 支付宝支付功能官方Demo调试实操2(知识点补充) 

###  11-6 支付宝支付功能开发1 

加alipay的jar包

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200217210355446.png" alt="image-20200217210355446" style="zoom:33%;" />

 本地包上传到服务器需要加插件

```xml
      <!-- geelynote maven的核心插件之-complier插件默认只支持编译Java 1.4，因此需要加上支持高版本jre的配置，在pom.xml里面加上 增加编译插件 -->
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <configuration>
          <source>1.7</source>
          <target>1.7</target>
          <encoding>UTF-8</encoding>
          <compilerArguments>
            <extdirs>${project.basedir}/src/main/webapp/WEB-INF/lib</extdirs>
          </compilerArguments>
        </configuration>
      </plugin>
```

###  11-7 支付宝支付功能开发2 
支付

```java
    @RequestMapping("pay.do")
    @ResponseBody
    public ServerResponse pay(HttpSession session, Long orderNo, HttpServletRequest request){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        String path = request.getSession().getServletContext().getRealPath("upload");
        return iOrderService.pay(orderNo,user.getId(),path);
    }

    public ServerResponse pay(Long orderNo,Integer userId,String path){
        Map<String ,String> resultMap = Maps.newHashMap();
        Order order = orderMapper.selectByUserIdAndOrderNo(userId,orderNo);
        if(order == null){
            return ServerResponse.createByErrorMessage("用户没有该订单");
        }
        resultMap.put("orderNo",String.valueOf(order.getOrderNo()));
        // (必填) 商户网站订单系统中唯一订单号，64个字符以内，只能包含字母、数字、下划线，
        // 需保证商户系统端不能重复，建议通过数据库sequence生成，
        String outTradeNo = order.getOrderNo().toString();
        // (必填) 订单标题，粗略描述用户的支付目的。如“xxx品牌xxx门店当面付扫码消费”
        String subject = new StringBuilder().append("happymmall扫码支付,订单号:").append(outTradeNo).toString();
        // (必填) 订单总金额，单位为元，不能超过1亿元
        // 如果同时传入了【打折金额】,【不可打折金额】,【订单总金额】三者,则必须满足如下条件:【订单总金额】=【打折金额】+【不可打折金额】
        String totalAmount = order.getPayment().toString();
        // (可选) 订单不可打折金额，可以配合商家平台配置折扣活动，如果酒水不参与打折，则将对应金额填写至此字段
        // 如果该值未传入,但传入了【订单总金额】,【打折金额】,则该值默认为【订单总金额】-【打折金额】
        String undiscountableAmount = "0";
        // 卖家支付宝账号ID，用于支持一个签约账号下支持打款到不同的收款账号，(打款到sellerId对应的支付宝账号)
        // 如果该字段为空，则默认为与支付宝签约的商户的PID，也就是appid对应的PID
        String sellerId = "";
        // 订单描述，可以对交易或商品进行一个详细地描述，比如填写"购买商品2件共15.00元"
        String body = new StringBuilder().append("订单").append(outTradeNo).append("购买商品共").append(totalAmount).append("元").toString();
        // 商户操作员编号，添加此参数可以为商户操作员做销售统计
        String operatorId = "test_operator_id";
        // (必填) 商户门店编号，通过门店号和商家后台可以配置精准到门店的折扣信息，详询支付宝技术支持
        String storeId = "test_store_id";
        // 业务扩展参数，目前可添加由支付宝分配的系统商编号(通过setSysServiceProviderId方法)，详情请咨询支付宝技术支持
        ExtendParams extendParams = new ExtendParams();
        extendParams.setSysServiceProviderId("2088100200300400500");
        // 支付超时，定义为120分钟
        String timeoutExpress = "120m";
        // 商品明细列表，需填写购买商品详细信息，
        List<GoodsDetail> goodsDetailList = new ArrayList<GoodsDetail>();
        List<OrderItem> orderItemList = orderItemMapper.getByOrderNoUserId(orderNo,userId);
        for(OrderItem orderItem : orderItemList){
            GoodsDetail goods = GoodsDetail.newInstance(orderItem.getProductId().toString(), orderItem.getProductName(),
                    BigDecimalUtil.mul(orderItem.getCurrentUnitPrice().doubleValue(),new Double(100).doubleValue()).longValue(),
                    orderItem.getQuantity());
            goodsDetailList.add(goods);
        }
        // 创建扫码支付请求builder，设置请求参数
        AlipayTradePrecreateRequestBuilder builder = new AlipayTradePrecreateRequestBuilder()
                .setSubject(subject).setTotalAmount(totalAmount).setOutTradeNo(outTradeNo)
                .setUndiscountableAmount(undiscountableAmount).setSellerId(sellerId).setBody(body)
                .setOperatorId(operatorId).setStoreId(storeId).setExtendParams(extendParams)
                .setTimeoutExpress(timeoutExpress)
                .setNotifyUrl(PropertiesUtil.getProperty("alipay.callback.url"))//支付宝服务器主动通知商户服务器里指定的页面http路径,根据需要设置
                .setGoodsDetailList(goodsDetailList);
        AlipayF2FPrecreateResult result = tradeService.tradePrecreate(builder);
        switch (result.getTradeStatus()) {
            case SUCCESS:
                logger.info("支付宝预下单成功: )");
                AlipayTradePrecreateResponse response = result.getResponse();
                dumpResponse(response);
                File folder = new File(path);
                if(!folder.exists()){
                    folder.setWritable(true);
                    folder.mkdirs();
                }
                // 需要修改为运行机器上的路径
                //细节细节细节
                String qrPath = String.format(path+"/qr-%s.png",response.getOutTradeNo());
                String qrFileName = String.format("qr-%s.png",response.getOutTradeNo());
                ZxingUtils.getQRCodeImge(response.getQrCode(), 256, qrPath);
                File targetFile = new File(path,qrFileName);
                try {
                    FTPUtil.uploadFile(Lists.newArrayList(targetFile));
                } catch (IOException e) {
                    logger.error("上传二维码异常",e);
                }
                logger.info("qrPath:" + qrPath);
                String qrUrl = PropertiesUtil.getProperty("ftp.server.http.prefix")+targetFile.getName();
                resultMap.put("qrUrl",qrUrl);
                return ServerResponse.createBySuccess(resultMap);
            case FAILED:
                logger.error("支付宝预下单失败!!!");
                return ServerResponse.createByErrorMessage("支付宝预下单失败!!!");
            case UNKNOWN:
                logger.error("系统异常，预下单状态未知!!!");
                return ServerResponse.createByErrorMessage("系统异常，预下单状态未知!!!");
            default:
                logger.error("不支持的交易状态，交易返回异常!!!");
                return ServerResponse.createByErrorMessage("不支持的交易状态，交易返回异常!!!");
        }
    }
```

###  11-8 支付宝支付回调函数实现与支付宝SDK源码解析 

```java
    @RequestMapping("alipay_callback.do")
    @ResponseBody
    public Object alipayCallback(HttpServletRequest request){
        Map<String,String> params = Maps.newHashMap();
        Map requestParams = request.getParameterMap();
        for(Iterator iter = requestParams.keySet().iterator();iter.hasNext();){
            String name = (String)iter.next();
            String[] values = (String[]) requestParams.get(name);
            String valueStr = "";
            for(int i = 0 ; i <values.length;i++){

                valueStr = (i == values.length -1)?valueStr + values[i]:valueStr + values[i]+",";
            }
            params.put(name,valueStr);
        }
        logger.info("支付宝回调,sign:{},trade_status:{},参数:{}",params.get("sign"),params.get("trade_status"),params.toString());
        //非常重要,验证回调的正确性,是不是支付宝发的.并且呢还要避免重复通知.
        params.remove("sign_type");
        try {
            boolean alipayRSACheckedV2 = AlipaySignature.rsaCheckV2(params, Configs.getAlipayPublicKey(),"utf-8",Configs.getSignType());

            if(!alipayRSACheckedV2){
                return ServerResponse.createByErrorMessage("非法请求,验证不通过,再恶意请求我就报警找网警了");
            }
        } catch (AlipayApiException e) {
            logger.error("支付宝验证回调异常",e);
        }
        //todo 验证各种数据
        ServerResponse serverResponse = iOrderService.aliCallback(params);
        if(serverResponse.isSuccess()){
            return Const.AlipayCallback.RESPONSE_SUCCESS;
        }
        return Const.AlipayCallback.RESPONSE_FAILED;
    }

    public ServerResponse aliCallback(Map<String,String> params){
        Long orderNo = Long.parseLong(params.get("out_trade_no"));
        String tradeNo = params.get("trade_no");
        String tradeStatus = params.get("trade_status");
        Order order = orderMapper.selectByOrderNo(orderNo);
        if(order == null){
            return ServerResponse.createByErrorMessage("非快乐慕商城的订单,回调忽略");
        }
        if(order.getStatus() >= Const.OrderStatusEnum.PAID.getCode()){
            return ServerResponse.createBySuccess("支付宝重复调用");
        }
        if(Const.AlipayCallback.TRADE_STATUS_TRADE_SUCCESS.equals(tradeStatus)){
            order.setPaymentTime(DateTimeUtil.strToDate(params.get("gmt_payment")));
            order.setStatus(Const.OrderStatusEnum.PAID.getCode());
            orderMapper.updateByPrimaryKeySelective(order);
        }
        PayInfo payInfo = new PayInfo();
        payInfo.setUserId(order.getUserId());
        payInfo.setOrderNo(order.getOrderNo());
        payInfo.setPayPlatform(Const.PayPlatformEnum.ALIPAY.getCode());
        payInfo.setPlatformNumber(tradeNo);
        payInfo.setPlatformStatus(tradeStatus);
        payInfoMapper.insert(payInfo);
        return ServerResponse.createBySuccess();
    }
```

###  11-9 查询订单支付状态功能开发 

```java
    @RequestMapping("query_order_pay_status.do")
    @ResponseBody
    public ServerResponse<Boolean> queryOrderPayStatus(HttpSession session, Long orderNo){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }

        ServerResponse serverResponse = iOrderService.queryOrderPayStatus(user.getId(),orderNo);
        if(serverResponse.isSuccess()){
            return ServerResponse.createBySuccess(true);
        }
        return ServerResponse.createBySuccess(false);
    }

    public ServerResponse queryOrderPayStatus(Integer userId,Long orderNo){
        Order order = orderMapper.selectByUserIdAndOrderNo(userId,orderNo);
        if(order == null){
            return ServerResponse.createByErrorMessage("用户没有该订单");
        }
        if(order.getStatus() >= Const.OrderStatusEnum.PAID.getCode()){
            return ServerResponse.createBySuccess();
        }
        return ServerResponse.createByError();
    }
```

###  11-10 支付模块所有功能自测 

# 第12章 订单管理模块开发

###  12-1 订单模块开发概要及接口设计讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200218215943020.png" alt="image-20200218215943020" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200218220006944.png" alt="image-20200218220006944" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200218220724248.png" alt="image-20200218220724248" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200218220822906.png" alt="image-20200218220822906" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200218220837855.png" alt="image-20200218220837855" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200218221848125.png" alt="image-20200218221848125" style="zoom:33%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200218221710777.png" alt="image-20200218221710777" style="zoom:25%;" />

https://gitee.com/imooccode/happymmallwiki/wikis/门户_订单接口

###  12-2 创建订单，清空购物车等功能开发1 

```java
    @RequestMapping("create.do")
    @ResponseBody
    public ServerResponse create(HttpSession session, Integer shippingId){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iOrderService.createOrder(user.getId(),shippingId);
    }

    public  ServerResponse createOrder(Integer userId,Integer shippingId){
        //从购物车中获取数据
        List<Cart> cartList = cartMapper.selectCheckedCartByUserId(userId);
        //计算这个订单的总价
        ServerResponse serverResponse = this.getCartOrderItem(userId,cartList);
        if(!serverResponse.isSuccess()){
            return serverResponse;
        }
        List<OrderItem> orderItemList = (List<OrderItem>)serverResponse.getData();
        BigDecimal payment = this.getOrderTotalPrice(orderItemList);
        //生成订单
        Order order = this.assembleOrder(userId,shippingId,payment);
        if(order == null){
            return ServerResponse.createByErrorMessage("生成订单错误");
        }
        if(CollectionUtils.isEmpty(orderItemList)){
            return ServerResponse.createByErrorMessage("购物车为空");
        }
        for(OrderItem orderItem : orderItemList){
            orderItem.setOrderNo(order.getOrderNo());
        }
        //mybatis 批量插入
        orderItemMapper.batchInsert(orderItemList);
        //生成成功,我们要减少我们产品的库存
        this.reduceProductStock(orderItemList);
        //清空一下购物车
        this.cleanCart(cartList);
        //返回给前端数据
        OrderVo orderVo = assembleOrderVo(order,orderItemList);
        return ServerResponse.createBySuccess(orderVo);
    }
```

getCartOrderItem

```java


    private ServerResponse getCartOrderItem(Integer userId,List<Cart> cartList){
        List<OrderItem> orderItemList = Lists.newArrayList();
        if(CollectionUtils.isEmpty(cartList)){
            return ServerResponse.createByErrorMessage("购物车为空");
        }
        //校验购物车的数据,包括产品的状态和数量
        for(Cart cartItem : cartList){
            OrderItem orderItem = new OrderItem();
            Product product = productMapper.selectByPrimaryKey(cartItem.getProductId());
            if(Const.ProductStatusEnum.ON_SALE.getCode() != product.getStatus()){
                return ServerResponse.createByErrorMessage("产品"+product.getName()+"不是在线售卖状态");
            }
            //校验库存
            if(cartItem.getQuantity() > product.getStock()){
                return ServerResponse.createByErrorMessage("产品"+product.getName()+"库存不足");
            }
            orderItem.setUserId(userId);
            orderItem.setProductId(product.getId());
            orderItem.setProductName(product.getName());
            orderItem.setProductImage(product.getMainImage());
            orderItem.setCurrentUnitPrice(product.getPrice());
            orderItem.setQuantity(cartItem.getQuantity());
            orderItem.setTotalPrice(BigDecimalUtil.mul(product.getPrice().doubleValue(),cartItem.getQuantity()));
            orderItemList.add(orderItem);
        }
        return ServerResponse.createBySuccess(orderItemList);
    }
```

assembleOrder

```java
    private Order assembleOrder(Integer userId,Integer shippingId,BigDecimal payment){
        Order order = new Order();
        long orderNo = this.generateOrderNo();
        order.setOrderNo(orderNo);
        order.setStatus(Const.OrderStatusEnum.NO_PAY.getCode());
        order.setPostage(0);
        order.setPaymentType(Const.PaymentTypeEnum.ONLINE_PAY.getCode());
        order.setPayment(payment);
        order.setUserId(userId);
        order.setShippingId(shippingId);
        //发货时间等等
        //付款时间等等
        int rowCount = orderMapper.insert(order);
        if(rowCount > 0){
            return order;
        }
        return null;
    }

    private long generateOrderNo(){
        long currentTime =System.currentTimeMillis();
        return currentTime+new Random().nextInt(100);
    }
```

### 12-3 创建订单，清空购物车等功能开发2 

getOrderTotalPrice

```java
    private BigDecimal getOrderTotalPrice(List<OrderItem> orderItemList){
        BigDecimal payment = new BigDecimal("0");
        for(OrderItem orderItem : orderItemList){
            payment = BigDecimalUtil.add(payment.doubleValue(),orderItem.getTotalPrice().doubleValue());
        }
        return payment;
    }
```

reduceProductStock

```java
    private void reduceProductStock(List<OrderItem> orderItemList){
        for(OrderItem orderItem : orderItemList){
            Product product = productMapper.selectByPrimaryKey(orderItem.getProductId());
            product.setStock(product.getStock()-orderItem.getQuantity());
            productMapper.updateByPrimaryKeySelective(product);
        }
    }
```

cleanCart

```java
    private void cleanCart(List<Cart> cartList){
        for(Cart cart : cartList){
            cartMapper.deleteByPrimaryKey(cart.getId());
        }
    }
```

assembleOrderVo

```java
    private OrderVo assembleOrderVo(Order order,List<OrderItem> orderItemList){
        OrderVo orderVo = new OrderVo();
        orderVo.setOrderNo(order.getOrderNo());
        orderVo.setPayment(order.getPayment());
        orderVo.setPaymentType(order.getPaymentType());
        orderVo.setPaymentTypeDesc(Const.PaymentTypeEnum.codeOf(order.getPaymentType()).getValue());
        orderVo.setPostage(order.getPostage());
        orderVo.setStatus(order.getStatus());
        orderVo.setStatusDesc(Const.OrderStatusEnum.codeOf(order.getStatus()).getValue());
        orderVo.setShippingId(order.getShippingId());
        Shipping shipping = shippingMapper.selectByPrimaryKey(order.getShippingId());
        if(shipping != null){
            orderVo.setReceiverName(shipping.getReceiverName());
            orderVo.setShippingVo(assembleShippingVo(shipping));
        }
        orderVo.setPaymentTime(DateTimeUtil.dateToStr(order.getPaymentTime()));
        orderVo.setSendTime(DateTimeUtil.dateToStr(order.getSendTime()));
        orderVo.setEndTime(DateTimeUtil.dateToStr(order.getEndTime()));
        orderVo.setCreateTime(DateTimeUtil.dateToStr(order.getCreateTime()));
        orderVo.setCloseTime(DateTimeUtil.dateToStr(order.getCloseTime()));
        orderVo.setImageHost(PropertiesUtil.getProperty("ftp.server.http.prefix"));
        List<OrderItemVo> orderItemVoList = Lists.newArrayList();
        for(OrderItem orderItem : orderItemList){
            OrderItemVo orderItemVo = assembleOrderItemVo(orderItem);
            orderItemVoList.add(orderItemVo);
        }
        orderVo.setOrderItemVoList(orderItemVoList);
        return orderVo;
    }
```

###  12-4 取消订单，获取购物车中商品信息功能开发 

```java
    @RequestMapping("cancel.do")
    @ResponseBody
    public ServerResponse cancel(HttpSession session, Long orderNo){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iOrderService.cancel(user.getId(),orderNo);
    }

    public ServerResponse<String> cancel(Integer userId,Long orderNo){
        Order order  = orderMapper.selectByUserIdAndOrderNo(userId,orderNo);
        if(order == null){
            return ServerResponse.createByErrorMessage("该用户此订单不存在");
        }
        if(order.getStatus() != Const.OrderStatusEnum.NO_PAY.getCode()){
            return ServerResponse.createByErrorMessage("已付款,无法取消订单");
        }
        Order updateOrder = new Order();
        updateOrder.setId(order.getId());
        updateOrder.setStatus(Const.OrderStatusEnum.CANCELED.getCode());
        int row = orderMapper.updateByPrimaryKeySelective(updateOrder);
        if(row > 0){
            return ServerResponse.createBySuccess();
        }
        return ServerResponse.createByError();
    }
```

```java
    @RequestMapping("get_order_cart_product.do")
    @ResponseBody
    public ServerResponse getOrderCartProduct(HttpSession session){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iOrderService.getOrderCartProduct(user.getId());
    }

    public ServerResponse getOrderCartProduct(Integer userId){
        OrderProductVo orderProductVo = new OrderProductVo();
        //从购物车中获取数据
        List<Cart> cartList = cartMapper.selectCheckedCartByUserId(userId);
        ServerResponse serverResponse =  this.getCartOrderItem(userId,cartList);
        if(!serverResponse.isSuccess()){
            return serverResponse;
        }
        List<OrderItem> orderItemList =( List<OrderItem> ) serverResponse.getData();
        List<OrderItemVo> orderItemVoList = Lists.newArrayList();
        BigDecimal payment = new BigDecimal("0");
        for(OrderItem orderItem : orderItemList){
            payment = BigDecimalUtil.add(payment.doubleValue(),orderItem.getTotalPrice().doubleValue());
            orderItemVoList.add(assembleOrderItemVo(orderItem));
        }
        orderProductVo.setProductTotalPrice(payment);
        orderProductVo.setOrderItemVoList(orderItemVoList);
        orderProductVo.setImageHost(PropertiesUtil.getProperty("ftp.server.http.prefix"));
        return ServerResponse.createBySuccess(orderProductVo);
    }
```

###  12-5 前后台订单列表，订单详情，发货功能开发 

```java
    @RequestMapping("detail.do")
    @ResponseBody
    public ServerResponse detail(HttpSession session,Long orderNo){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iOrderService.getOrderDetail(user.getId(),orderNo);
    }

    public ServerResponse<OrderVo> getOrderDetail(Integer userId,Long orderNo){
        Order order = orderMapper.selectByUserIdAndOrderNo(userId,orderNo);
        if(order != null){
            List<OrderItem> orderItemList = orderItemMapper.getByOrderNoUserId(orderNo,userId);
            OrderVo orderVo = assembleOrderVo(order,orderItemList);
            return ServerResponse.createBySuccess(orderVo);
        }
        return  ServerResponse.createByErrorMessage("没有找到该订单");
    }
```

```java
    @RequestMapping("list.do")
    @ResponseBody
    public ServerResponse list(HttpSession session, @RequestParam(value = "pageNum",defaultValue = "1") int pageNum, @RequestParam(value = "pageSize",defaultValue = "10") int pageSize){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user ==null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),ResponseCode.NEED_LOGIN.getDesc());
        }
        return iOrderService.getOrderList(user.getId(),pageNum,pageSize);
    }

    public ServerResponse<PageInfo> getOrderList(Integer userId,int pageNum,int pageSize){
        PageHelper.startPage(pageNum,pageSize);
        List<Order> orderList = orderMapper.selectByUserId(userId);
        List<OrderVo> orderVoList = assembleOrderVoList(orderList,userId);
        PageInfo pageResult = new PageInfo(orderList);
        pageResult.setList(orderVoList);
        return ServerResponse.createBySuccess(pageResult);
    }

    private List<OrderVo> assembleOrderVoList(List<Order> orderList,Integer userId){
        List<OrderVo> orderVoList = Lists.newArrayList();
        for(Order order : orderList){
            List<OrderItem>  orderItemList = Lists.newArrayList();
            if(userId == null){
                //todo 管理员查询的时候 不需要传userId
                orderItemList = orderItemMapper.getByOrderNo(order.getOrderNo());
            }else{
                orderItemList = orderItemMapper.getByOrderNoUserId(order.getOrderNo(),userId);
            }
            OrderVo orderVo = assembleOrderVo(order,orderItemList);
            orderVoList.add(orderVo);
        }
        return orderVoList;
    }
```

管理员

```java
    @RequestMapping("list.do")
    @ResponseBody
    public ServerResponse<PageInfo> orderList(HttpSession session, @RequestParam(value = "pageNum",defaultValue = "1") int pageNum,
                                              @RequestParam(value = "pageSize",defaultValue = "10")int pageSize){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),"用户未登录,请登录管理员");

        }
        if(iUserService.checkAdminRole(user).isSuccess()){
            //填充我们增加产品的业务逻辑
            return iOrderService.manageList(pageNum,pageSize);
        }else{
            return ServerResponse.createByErrorMessage("无权限操作");
        }
    }

    public ServerResponse<PageInfo> manageList(int pageNum,int pageSize){
        PageHelper.startPage(pageNum,pageSize);
        List<Order> orderList = orderMapper.selectAllOrder();
        List<OrderVo> orderVoList = this.assembleOrderVoList(orderList,null);
        PageInfo pageResult = new PageInfo(orderList);
        pageResult.setList(orderVoList);
        return ServerResponse.createBySuccess(pageResult);
    }
```

```java
    @RequestMapping("detail.do")
    @ResponseBody
    public ServerResponse<OrderVo> orderDetail(HttpSession session, Long orderNo){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),"用户未登录,请登录管理员");

        }
        if(iUserService.checkAdminRole(user).isSuccess()){
            //填充我们增加产品的业务逻辑
            return iOrderService.manageDetail(orderNo);
        }else{
            return ServerResponse.createByErrorMessage("无权限操作");
        }
    }

    public ServerResponse<OrderVo> manageDetail(Long orderNo) {
        Order order = orderMapper.selectByOrderNo(orderNo);
        if (order != null) {
            List<OrderItem> orderItemList = orderItemMapper.getByOrderNo(orderNo);
            OrderVo orderVo = assembleOrderVo(order, orderItemList);
            return ServerResponse.createBySuccess(orderVo);
        }
        return ServerResponse.createByErrorMessage("订单不存在");
    }
```

```java
    @RequestMapping("search.do")
    @ResponseBody
    public ServerResponse<PageInfo> orderSearch(HttpSession session, Long orderNo,@RequestParam(value = "pageNum",defaultValue = "1") int pageNum,
                                               @RequestParam(value = "pageSize",defaultValue = "10")int pageSize){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),"用户未登录,请登录管理员");
        }
        if(iUserService.checkAdminRole(user).isSuccess()){
            //填充我们增加产品的业务逻辑
            return iOrderService.manageSearch(orderNo,pageNum,pageSize);
        }else{
            return ServerResponse.createByErrorMessage("无权限操作");
        }
    }

    public ServerResponse<PageInfo> manageSearch(Long orderNo, int pageNum, int pageSize) {
        PageHelper.startPage(pageNum, pageSize);
        Order order = orderMapper.selectByOrderNo(orderNo);
        if (order != null) {
            List<OrderItem> orderItemList = orderItemMapper.getByOrderNo(orderNo);
            OrderVo orderVo = assembleOrderVo(order, orderItemList);
            PageInfo pageResult = new PageInfo(Lists.newArrayList(order));
            pageResult.setList(Lists.newArrayList(orderVo));
            return ServerResponse.createBySuccess(pageResult);
        }
        return ServerResponse.createByErrorMessage("订单不存在");
    }
```

```java
    @RequestMapping("send_goods.do")
    @ResponseBody
    public ServerResponse<String> orderSendGoods(HttpSession session, Long orderNo){
        User user = (User)session.getAttribute(Const.CURRENT_USER);
        if(user == null){
            return ServerResponse.createByErrorCodeMessage(ResponseCode.NEED_LOGIN.getCode(),"用户未登录,请登录管理员");
        }
        if(iUserService.checkAdminRole(user).isSuccess()){
            //填充我们增加产品的业务逻辑
            return iOrderService.manageSendGoods(orderNo);
        }else{
            return ServerResponse.createByErrorMessage("无权限操作");
        }
    }

    public ServerResponse<String> manageSendGoods(Long orderNo) {
        Order order = orderMapper.selectByOrderNo(orderNo);
        if (order != null) {
            if (order.getStatus() == Const.OrderStatusEnum.PAID.getCode()) {
                order.setStatus(Const.OrderStatusEnum.SHIPPED.getCode());
                order.setSendTime(new Date());
                orderMapper.updateByPrimaryKeySelective(order);
                return ServerResponse.createBySuccess("发货成功");
            }
        }
        return ServerResponse.createByErrorMessage("订单不存在");
    }
```

###   12-6 订单管理模块所有功能自测 

# 第13章 云服务器线上部署与自动化发布，验证，故障排查与解决

###  13-1 云服务器部署概要讲解 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200219000723759.png" alt="image-20200219000723759" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200219000806695.png" alt="image-20200219000806695" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200219001255113.png" alt="image-20200219001255113" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200219001327687.png" alt="image-20200219001327687" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200219001403898.png" alt="image-20200219001403898" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200219003831833.png" alt="image-20200219003831833" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200219003912610.png" alt="image-20200219003912610" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200219004115137.png" alt="image-20200219004115137" style="zoom: 50%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200219005323977.png" alt="image-20200219005323977" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200219005335554.png" alt="image-20200219005335554" style="zoom:25%;" />

###  13-2 云服务器购买、管理、配置实操 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200219104719702.png" alt="image-20200219104719702" style="zoom:25%;" />

###  13-3 线上域名购买、解析讲解 

###  13-4 线上云服务器用户创建实操 

###  13-5 线上环境安装配置实操(jdk-tomcat-maven-vsftpd-nginx) 

### 13-6 线上环境安装配置实操（mysql） 

###  13-7 线上环境安装配置实操（git） 

###  13-8 线上防火墙配置实操 

###  13-9 服务端项目自动化发布、验证、故障排查与解决 

# 第14章 课程回顾与二期展望

###  14-1 课程回顾与下期展望 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111009134.png" alt="image-20200220111009134" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111029182.png" alt="image-20200220111029182" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220011051212.png" alt="image-20200220011051212" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220011814790.png" alt="image-20200220011814790" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220011831765.png" alt="image-20200220011831765" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220011948432.png" alt="image-20200220011948432" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111459266.png" alt="image-20200220111459266" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111514129.png" alt="image-20200220111514129" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111542268.png" alt="image-20200220111542268" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111127913.png" alt="image-20200220111127913" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111202791.png" alt="image-20200220111202791" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111610588.png" alt="image-20200220111610588" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111655482.png" alt="image-20200220111655482" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111232478.png" alt="image-20200220111232478" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111258232.png" alt="image-20200220111258232" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111320343.png" alt="image-20200220111320343" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220110932149.png" alt="image-20200220110932149" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111352644.png" alt="image-20200220111352644" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111417623.png" alt="image-20200220111417623" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111829116.png" alt="image-20200220111829116" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111853074.png" alt="image-20200220111853074" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111909311.png" alt="image-20200220111909311" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111922587.png" alt="image-20200220111922587" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111940238.png" alt="image-20200220111940238" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220111956614.png" alt="image-20200220111956614" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220112015156.png" alt="image-20200220112015156" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220112034726.png" alt="image-20200220112034726" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220112056648.png" alt="image-20200220112056648" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220112115919.png" alt="image-20200220112115919" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220112137380.png" alt="image-20200220112137380" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220112156138.png" alt="image-20200220112156138" style="zoom:25%;" />

# 第15章 二期课程体验

###  15-1 二期课程导学 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220130447423.png" alt="image-20200220130447423" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220131903266.png" alt="image-20200220131903266" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220131843366.png" alt="image-20200220131843366" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220132424514.png" alt="image-20200220132424514" style="zoom:25%;" />

一期架构

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220132447730.png" alt="image-20200220132447730" style="zoom:25%;" />

二期架构

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220134022927.png" alt="image-20200220134022927" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220134059215.png" alt="image-20200220134059215" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220134128609.png" alt="image-20200220134128609" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220134150441.png" alt="image-20200220134150441" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220134216620.png" alt="image-20200220134216620" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220134234029.png" alt="image-20200220134234029" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220134248330.png" alt="image-20200220134248330" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220134316044.png" alt="image-20200220134316044" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220134341656.png" alt="image-20200220134341656" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220134402180.png" alt="image-20200220134402180" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220134428897.png" alt="image-20200220134428897" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145133821.png" alt="image-20200220145133821" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145152616.png" alt="image-20200220145152616" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145243463.png" alt="image-20200220145243463" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145303100.png" alt="image-20200220145303100" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145428349.png" alt="image-20200220145428349" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145453271.png" alt="image-20200220145453271" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145522736.png" alt="image-20200220145522736" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145538463.png" alt="image-20200220145538463" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145600416.png" alt="image-20200220145600416" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145625269.png" alt="image-20200220145625269" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145648533.png" alt="image-20200220145648533" style="zoom:25%;" />

###  15-2 一期二期课程使用的系统及技术版本介绍 

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145812638.png" alt="image-20200220145812638" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145915140.png" alt="image-20200220145915140" style="zoom:25%;" />

<img src="http://woshiamiaojiang.gitee.io/image-hosting/image-20200220145945482.png" alt="image-20200220145945482" style="zoom:25%;" />



# 第16章 前端课程体验

# 第17章 设计模式课程体验 

